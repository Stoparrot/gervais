import{a as Ut,n as Yt,b as d,c as fe,t as I,d as Xt}from"../chunks/CD-cSNpP.js";import{i as Ke}from"../chunks/DSKYDh3O.js";import{v as It,b as St,s as Ge,h as ge,j as Et,a as nt,G as e,aa as pe,c as Jt,r as $t,d as Ue,g as je,m as Qt,e as pt,f as ft,p as Ct,aD as st,t as zt,a7 as Zt,y as ct,aE as mt,aF as wt,aG as gt,B as ea,$ as kt,aH as Pt,a4 as qt,aI as ta,aJ as aa,q as sa,aK as oa,aL as jt,aM as ra,k as la,E as ia,aN as na,aO as ca,N as Tt,a6 as da,a5 as va,w as Re,V as c,X as k,T as U,z as Ve,W as l,S as ve,aP as ht,aQ as ne,al as Ye,aR as Qe,aS as _t,D as m,aT as Oe,P as xt,aU as ke}from"../chunks/BSv_i5Hy.js";import{s as he}from"../chunks/XUjQEjo_.js";import{i as F}from"../chunks/Cec3cEQU.js";import{l as ua,m as pa,o as oe,p as fa}from"../chunks/Bl1F-iLh.js";import{i as ma,l as $e,p as ae,s as Ce,b as bt}from"../chunks/DYD2hZ7I.js";import{a as Te,s as yt}from"../chunks/HG7v26tk.js";import{s as Ae,b as dt,C as ga,d as Ne,a as ye,e as Nt,c as ie,f as ha,r as Je}from"../chunks/vjcQaIlh.js";import{i as _a,o as ba,g as ya,b as $a,l as wa,c as ka,s as vt,v as xa,u as Aa,e as Ma,f as Ia,h as Sa,j as Ea,k as Ca}from"../chunks/Fmf_jR6z.js";import{M as ot}from"../chunks/WrD4_mq6.js";function Ie(s,t){return t}function za(s,t,o,_){for(var a=[],f=t.length,i=0;i<f;i++)aa(t[i].e,a,!0);var r=f>0&&a.length===0&&o!==null;if(r){var O=o.parentNode;sa(O),O.append(o),_.clear(),qe(s,t[0].prev,t[f-1].next)}oa(a,()=>{for(var v=0;v<f;v++){var n=t[v];r||(_.delete(n.k),qe(s,n.prev,n.next)),jt(n.e,!r)}})}function Se(s,t,o,_,a,f=null){var i=s,r={flags:t,items:new Map,first:null},O=(t&Pt)!==0;if(O){var v=s;i=ge?Ge(Et(v)):v.appendChild(It())}ge&&nt();var n=null,z=!1,g=pe(()=>{var p=o();return qt(p)?p:p==null?[]:zt(p)});St(()=>{var p=e(g),h=p.length;if(z&&h===0)return;z=h===0;let j=!1;if(ge){var S=i.data===Jt;S!==(h===0)&&(i=$t(),Ge(i),Ue(!1),j=!0)}if(ge){for(var K=null,Y,B=0;B<h;B++){if(je.nodeType===8&&je.data===Qt){i=je,j=!0,Ue(!1);break}var q=p[B],D=_(q,B);Y=Ot(je,r,K,null,q,D,B,a,t,o),r.items.set(D,Y),K=Y}h>0&&Ge($t())}ge||Pa(p,r,i,a,t,_,o),f!==null&&(h===0?n?pt(n):n=ft(()=>f(i)):n!==null&&Ct(n,()=>{n=null})),j&&Ue(!0),e(g)}),ge&&(i=je)}function Pa(s,t,o,_,a,f,i){var ee,se,le,G;var r=(a&ta)!==0,O=(a&(mt|gt))!==0,v=s.length,n=t.items,z=t.first,g=z,p,h=null,j,S=[],K=[],Y,B,q,D;if(r)for(D=0;D<v;D+=1)Y=s[D],B=f(Y,D),q=n.get(B),q!==void 0&&((ee=q.a)==null||ee.measure(),(j??(j=new Set)).add(q));for(D=0;D<v;D+=1){if(Y=s[D],B=f(Y,D),q=n.get(B),q===void 0){var _e=g?g.e.nodes_start:o;h=Ot(_e,t,h,h===null?t.first:h.next,Y,B,D,_,a,i),n.set(B,h),S=[],K=[],g=h.next;continue}if(O&&qa(q,Y,D,a),(q.e.f&st)!==0&&(pt(q.e),r&&((se=q.a)==null||se.unfix(),(j??(j=new Set)).delete(q))),q!==g){if(p!==void 0&&p.has(q)){if(S.length<K.length){var E=K[0],C;h=E.prev;var V=S[0],Q=S[S.length-1];for(C=0;C<S.length;C+=1)At(S[C],E,o);for(C=0;C<K.length;C+=1)p.delete(K[C]);qe(t,V.prev,Q.next),qe(t,h,V),qe(t,Q,E),g=E,h=Q,D-=1,S=[],K=[]}else p.delete(q),At(q,g,o),qe(t,q.prev,q.next),qe(t,q,h===null?t.first:h.next),qe(t,h,q),h=q;continue}for(S=[],K=[];g!==null&&g.k!==B;)(g.e.f&st)===0&&(p??(p=new Set)).add(g),K.push(g),g=g.next;if(g===null)continue;q=g}S.push(q),h=q,g=q.next}if(g!==null||p!==void 0){for(var W=p===void 0?[]:zt(p);g!==null;)(g.e.f&st)===0&&W.push(g),g=g.next;var J=W.length;if(J>0){var re=(a&Pt)!==0&&v===0?o:null;if(r){for(D=0;D<J;D+=1)(le=W[D].a)==null||le.measure();for(D=0;D<J;D+=1)(G=W[D].a)==null||G.fix()}za(t,W,re,n)}}r&&Zt(()=>{var ce;if(j!==void 0)for(q of j)(ce=q.a)==null||ce.apply()}),ct.first=t.first&&t.first.e,ct.last=h&&h.e}function qa(s,t,o,_){(_&mt)!==0&&wt(s.v,t),(_&gt)!==0?wt(s.i,o):s.i=o}function Ot(s,t,o,_,a,f,i,r,O,v){var n=(O&mt)!==0,z=(O&ra)===0,g=n?z?ea(a):kt(a):a,p=(O&gt)===0?i:kt(i),h={i:p,v:g,k:f,a:null,e:null,prev:o,next:_};try{return h.e=ft(()=>r(s,g,p,v),ge),h.e.prev=o&&o.e,h.e.next=_&&_.e,o===null?t.first=h:(o.next=h,o.e.next=h.e),_!==null&&(_.prev=h,_.e.prev=h.e),h}finally{}}function At(s,t,o){for(var _=s.next?s.next.e.nodes_start:o,a=t?t.e.nodes_start:o,f=s.e.nodes_start;f!==_;){var i=la(f);a.before(f),f=i}}function qe(s,t,o){t===null?s.first=o:(t.next=o,t.e.next=o&&o.e),o!==null&&(o.prev=t,o.e.prev=t&&t.e)}function ja(s,t,o,_,a,f){let i=ge;ge&&nt();var r,O,v=null;ge&&je.nodeType===1&&(v=je,nt());var n=ge?je:s,z;St(()=>{const g=t()||null;var p=na;g!==r&&(z&&(g===null?Ct(z,()=>{z=null,O=null}):g===O?pt(z):jt(z)),g&&g!==O&&(z=ft(()=>{if(v=ge?v:document.createElementNS(p,g),Ut(v,v),_){ge&&ua(g)&&v.append(document.createComment(""));var h=ge?Et(v):v.appendChild(It());ge&&(h===null?Ue(!1):Ge(h)),_(v,h)}ct.nodes_end=v,n.before(v)})),r=g,r&&(O=r))},ia),i&&(Ue(!0),Ge(n))}function We(s,t,o=t){var _=ca();pa(s,"input",a=>{var f=a?s.defaultValue:s.value;if(f=rt(s)?lt(f):f,o(f),_&&f!==(f=t())){var i=s.selectionStart,r=s.selectionEnd;s.value=f??"",r!==null&&(s.selectionStart=i,s.selectionEnd=Math.min(r,s.value.length))}}),(ge&&s.defaultValue!==s.value||Tt(t)==null&&s.value)&&o(rt(s)?lt(s.value):s.value),da(()=>{var a=t();rt(s)&&a===lt(s.value)||s.type==="date"&&!a&&!s.value||a!==s.value&&(s.value=a??"")})}function rt(s){var t=s.type;return t==="number"||t==="range"}function lt(s){return s===""?null:+s}function ut(s,t,o){if(s.multiple)return Na(s,t);for(var _ of s.options){var a=Lt(_);if(ma(a,t)){_.selected=!0;return}}(!o||t!==void 0)&&(s.selectedIndex=-1)}function Ta(s,t){let o=!0;va(()=>{t&&ut(s,Tt(t),o),o=!1;var _=new MutationObserver(()=>{var a=s.__value;ut(s,a)});return _.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{_.disconnect()}})}function Na(s,t){for(var o of s.options)o.selected=~t.indexOf(Lt(o))}function Lt(s){return"__value"in s?s.__value:s.value}function Oa(s){return function(...t){var o=t[0];o.target===this&&(s==null||s.apply(this,t))}}function Mt(s){return function(...t){var o=t[0];return o.stopPropagation(),s==null?void 0:s.apply(this,t)}}function it(s,t){var f;var o=(f=s.$$events)==null?void 0:f[t.type],_=qt(o)?o.slice():o==null?[]:[o];for(var a of _)a.call(this,t)}/**
 * @license lucide-svelte v0.479.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 */const La={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var Da=Yt("<svg><!><!></svg>");function ze(s,t){const o=$e(t,["children","$$slots","$$events","$$legacy"]),_=$e(o,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);Re(t,!1);let a=ae(t,"name",8,void 0),f=ae(t,"color",8,"currentColor"),i=ae(t,"size",8,24),r=ae(t,"strokeWidth",8,2),O=ae(t,"absoluteStrokeWidth",8,!1),v=ae(t,"iconNode",24,()=>[]);const n=(...j)=>j.filter((S,K,Y)=>!!S&&Y.indexOf(S)===K).join(" ");Ke();var z=Da();let g;var p=c(z);Se(p,1,v,Ie,(j,S)=>{let K=()=>e(S)[0],Y=()=>e(S)[1];var B=fe(),q=ve(B);ja(q,K,!0,(D,_e)=>{let E;U(()=>E=dt(D,E,{...Y()}))}),d(j,B)});var h=k(p);Ae(h,t,"default",{}),l(z),U((j,S)=>g=dt(z,g,{...La,..._,width:i(),height:i(),stroke:f(),"stroke-width":j,class:S}),[()=>O()?Number(r())*24/Number(i()):r(),()=>n("lucide-icon","lucide",a()?`lucide-${a()}`:"",o.class)],pe),d(s,z),Ve()}function Ha(s,t){const o=$e(t,["children","$$slots","$$events","$$legacy"]);ze(s,Ce({name:"chevron-left"},()=>o,{iconNode:[["path",{d:"m15 18-6-6 6-6"}]],children:(a,f)=>{var i=fe(),r=ve(i);Ae(r,t,"default",{}),d(a,i)},$$slots:{default:!0}}))}function Ka(s,t){const o=$e(t,["children","$$slots","$$events","$$legacy"]);ze(s,Ce({name:"circle-arrow-up"},()=>o,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m16 12-4-4-4 4"}],["path",{d:"M12 16V8"}]],children:(a,f)=>{var i=fe(),r=ve(i);Ae(r,t,"default",{}),d(a,i)},$$slots:{default:!0}}))}function Ra(s,t){const o=$e(t,["children","$$slots","$$events","$$legacy"]);ze(s,Ce({name:"globe"},()=>o,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"}],["path",{d:"M2 12h20"}]],children:(a,f)=>{var i=fe(),r=ve(i);Ae(r,t,"default",{}),d(a,i)},$$slots:{default:!0}}))}function Va(s,t){const o=$e(t,["children","$$slots","$$events","$$legacy"]);ze(s,Ce({name:"image"},()=>o,{iconNode:[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}],["circle",{cx:"9",cy:"9",r:"2"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"}]],children:(a,f)=>{var i=fe(),r=ve(i);Ae(r,t,"default",{}),d(a,i)},$$slots:{default:!0}}))}function Fa(s,t){const o=$e(t,["children","$$slots","$$events","$$legacy"]);ze(s,Ce({name:"mic"},()=>o,{iconNode:[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22"}]],children:(a,f)=>{var i=fe(),r=ve(i);Ae(r,t,"default",{}),d(a,i)},$$slots:{default:!0}}))}function Dt(s,t){const o=$e(t,["children","$$slots","$$events","$$legacy"]);ze(s,Ce({name:"notebook-pen"},()=>o,{iconNode:[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4"}],["path",{d:"M2 6h4"}],["path",{d:"M2 10h4"}],["path",{d:"M2 14h4"}],["path",{d:"M2 18h4"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"}]],children:(a,f)=>{var i=fe(),r=ve(i);Ae(r,t,"default",{}),d(a,i)},$$slots:{default:!0}}))}function Ht(s,t){const o=$e(t,["children","$$slots","$$events","$$legacy"]);ze(s,Ce({name:"paperclip"},()=>o,{iconNode:[["path",{d:"M13.234 20.252 21 12.3"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486"}]],children:(a,f)=>{var i=fe(),r=ve(i);Ae(r,t,"default",{}),d(a,i)},$$slots:{default:!0}}))}function Ba(s,t){const o=$e(t,["children","$$slots","$$events","$$legacy"]);ze(s,Ce({name:"settings"},()=>o,{iconNode:[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}],["circle",{cx:"12",cy:"12",r:"3"}]],children:(a,f)=>{var i=fe(),r=ve(i);Ae(r,t,"default",{}),d(a,i)},$$slots:{default:!0}}))}function Wa(s,t){const o=$e(t,["children","$$slots","$$events","$$legacy"]);ze(s,Ce({name:"video"},()=>o,{iconNode:[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2"}]],children:(a,f)=>{var i=fe(),r=ve(i);Ae(r,t,"default",{}),d(a,i)},$$slots:{default:!0}}))}function Kt(s,t){const o=$e(t,["children","$$slots","$$events","$$legacy"]);ze(s,Ce({name:"x"},()=>o,{iconNode:[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]],children:(a,f)=>{var i=fe(),r=ve(i);Ae(r,t,"default",{}),d(a,i)},$$slots:{default:!0}}))}var Ga=I('<div class="spinner svelte-1pi70xe"></div>'),Ua=I("<button><!> <!></button>");function xe(s,t){const o=$e(t,["children","$$slots","$$events","$$legacy"]),_=$e(o,["type","variant","size","disabled","loading","fullWidth"]);let a=ae(t,"type",8,"button"),f=ae(t,"variant",8,"primary"),i=ae(t,"size",8,"md"),r=ae(t,"disabled",8,!1),O=ae(t,"loading",8,!1),v=ae(t,"fullWidth",8,!1);var n=Ua();let z;var g=c(n);{var p=j=>{var S=Ga();d(j,S)};F(g,j=>{O()&&j(p)})}var h=k(g,2);Ae(h,t,"default",{}),l(n),U(j=>z=dt(n,z,{type:a(),class:`button ${f()??""} ${i()??""} ${(v()?"full-width":"")??""}`,disabled:r(),..._,[ga]:j},"svelte-1pi70xe"),[()=>({loading:O()})],pe),oe("click",n,function(j){it.call(this,t,j)}),oe("keydown",n,function(j){it.call(this,t,j)}),oe("keyup",n,function(j){it.call(this,t,j)}),d(s,n)}var Ya=I('<option class="svelte-1m60q0l"> </option>'),Xa=I('<optgroup label="Local Models" class="svelte-1m60q0l"></optgroup>'),Ja=I('<option class="svelte-1m60q0l"> </option>'),Qa=I('<option class="svelte-1m60q0l"> </option>'),Za=I('<option disabled class="svelte-1m60q0l"> </option>'),es=I('<!> <span class="svelte-1m60q0l">New Chat</span>',1),ts=I('<button type="button"><span class="chat-title svelte-1m60q0l"> </span> <!></button>'),as=I('<aside><div class="sidebar-header svelte-1m60q0l"><div class="logo-container svelte-1m60q0l"><img alt="Gervais Logo" class="logo svelte-1m60q0l"> <h2 class="svelte-1m60q0l">Gervais</h2></div> <!></div> <div class="sidebar-content svelte-1m60q0l"><div class="model-selector svelte-1m60q0l"><select class="select-styled svelte-1m60q0l"><!><optgroup label="OpenAI Models" class="svelte-1m60q0l"></optgroup><optgroup label="Google Models" class="svelte-1m60q0l"></optgroup><optgroup label="Anthropic Models (Disabled)" class="svelte-1m60q0l"></optgroup></select></div> <!> <div class="chats-list svelte-1m60q0l"></div></div></aside>');function ss(s,t){var ce;Re(t,!1);const[o,_]=yt(),a=()=>Te(Nt,"$activeChat",o),f=()=>Te(ka,"$allModelsStore",o),i=()=>Te(wa,"$localModelsStore",o),r=()=>Te(ie,"$chatStore",o);let O=ae(t,"isMobile",8,!1),v=ae(t,"isExpanded",8,!0);const n=ht();let z=ne(((ce=a())==null?void 0:ce.model.id)||"claude-3-5-sonnet");Ye(async()=>{await _a()});function g(){const H=f().find(w=>w.id===e(z));H&&ie.createNewChat(H)}function p(H){ie.selectChat(H),O()&&n("toggleSidebar",!1)}function h(H,w){w.stopPropagation(),ie.deleteChat(H)}function j(H){const w=H.target;if(m(z,w.value),a()){const y=f().find($=>$.id===e(z));y&&ie.updateChatModel(a().id,y)}}Qe(()=>a(),()=>{a()&&m(z,a().model.id)}),_t(),Ke();var S=as();let K;var Y=c(S),B=c(Y),q=c(B);Oe(2),l(B);var D=k(B,2);{var _e=H=>{const w=pe(()=>v()?"Collapse sidebar":"Expand sidebar");xe(H,{variant:"icon",size:"sm",class:"collapse-button",get"aria-label"(){return e(w)},$$events:{click:()=>n("toggleSidebar",!v())},children:(y,$)=>{Ha(y,{size:20})},$$slots:{default:!0}})};F(D,H=>{O()&&H(_e)})}l(Y);var E=k(Y,2),C=c(E),V=c(C);Ta(V,()=>e(z));var Q,W=c(V);{var J=H=>{var w=Xa();Se(w,5,i,Ie,(y,$)=>{var M=Ya(),x={},R=c(M,!0);l(M),U(()=>{x!==(x=e($).id)&&(M.value=(M.__value=e($).id)==null?"":e($).id),he(R,e($).name)}),d(y,M)}),l(w),d(H,w)};F(W,H=>{i().length>0&&H(J)})}var re=k(W);Se(re,5,()=>ba,Ie,(H,w)=>{var y=Ja(),$={},M=c(y,!0);l(y),U(()=>{$!==($=e(w).id)&&(y.value=(y.__value=e(w).id)==null?"":e(w).id),he(M,e(w).name)}),d(H,y)}),l(re);var ee=k(re);Se(ee,5,()=>ya,Ie,(H,w)=>{var y=Qa(),$={},M=c(y,!0);l(y),U(()=>{$!==($=e(w).id)&&(y.value=(y.__value=e(w).id)==null?"":e(w).id),he(M,e(w).name)}),d(H,y)}),l(ee);var se=k(ee);Se(se,5,()=>$a,Ie,(H,w)=>{var y=Za(),$={},M=c(y,!0);l(y),U(()=>{$!==($=e(w).id)&&(y.value=(y.__value=e(w).id)==null?"":e(w).id),he(M,e(w).name)}),d(H,y)}),l(se),l(V),l(C);var le=k(C,2);xe(le,{variant:"primary",size:"md",fullWidth:!0,class:"new-chat-button",$$events:{click:g},children:(H,w)=>{var y=es(),$=ve(y);Dt($,{size:16}),Oe(2),d(H,y)},$$slots:{default:!0}});var G=k(le,2);Se(G,5,()=>r().chats,Ie,(H,w)=>{var y=ts();let $;var M=c(y),x=c(M,!0);l(M);var R=k(M,2);xe(R,{variant:"icon",size:"sm","aria-label":"Delete chat",$$events:{click:P=>h(e(w).id,P)},children:(P,te)=>{Kt(P,{size:16})},$$slots:{default:!0}}),l(y),U(P=>{$=Ne(y,1,"chat-item svelte-1m60q0l",null,$,P),he(x,e(w).title||"New Chat")},[()=>{var P;return{active:e(w).id===((P=a())==null?void 0:P.id)}}],pe),oe("click",y,()=>p(e(w).id)),d(H,y)}),l(G),l(E),l(S),U(H=>{K=Ne(S,1,"sidebar svelte-1m60q0l",null,K,H),ye(q,"src","/gervais/logo.svg"),Q!==(Q=e(z))&&(V.value=(V.__value=e(z))==null?"":e(z),ut(V,e(z)))},[()=>({expanded:v()})],pe),oe("change",V,j),d(s,S),Ve(),_()}var os=I('<button type="button" class="media-preview-button svelte-1mjurqb"><img class="media-preview svelte-1mjurqb"></button>'),rs=I('<audio controls class="media-preview svelte-1mjurqb">Your browser does not support the audio element.</audio>'),ls=I('<video controls class="media-preview svelte-1mjurqb"><track kind="captions" src="" label="English captions" class="svelte-1mjurqb"> Your browser does not support the video element.</video>',2),is=I('<div class="file-size svelte-1mjurqb"> </div>'),ns=I('<span class="document-status success svelte-1mjurqb"> </span>'),cs=I('<span class="document-status info svelte-1mjurqb">Document attached</span>'),ds=I('<span class="document-status success svelte-1mjurqb">Document processed</span>'),vs=I('<span class="document-status info svelte-1mjurqb">Document</span>'),us=I('<span class="document-status error svelte-1mjurqb">Failed to process document</span>'),ps=I('<div class="document-file svelte-1mjurqb" role="button" tabindex="0"><div class="file-icon svelte-1mjurqb">📄</div> <div class="file-info svelte-1mjurqb"><div class="file-name svelte-1mjurqb"> </div> <!> <div class="file-status svelte-1mjurqb"><!></div></div></div>'),fs=I('<div class="media-container svelte-1mjurqb"></div>'),ms=I('<div class="message-bubble svelte-1mjurqb"><div class="content svelte-1mjurqb"><p class="svelte-1mjurqb"> </p></div> <!></div>'),gs=I('<button type="button" class="media-preview-button svelte-1mjurqb"><img class="media-preview svelte-1mjurqb"> <div class="image-caption svelte-1mjurqb">Click to view full size</div></button>'),hs=I('<audio controls class="media-preview svelte-1mjurqb">Your browser does not support the audio element.</audio>'),_s=I('<video controls class="media-preview svelte-1mjurqb"><track kind="captions" src="" label="English captions" class="svelte-1mjurqb"> Your browser does not support the video element.</video>',2),bs=I('<div class="media-container assistant-media svelte-1mjurqb"></div>'),ys=I('<details class="thinking svelte-1mjurqb"><summary class="svelte-1mjurqb">Show thinking</summary> <div class="thinking-content svelte-1mjurqb"><!></div></details>'),$s=I('<div class="typing-indicator svelte-1mjurqb"><span class="svelte-1mjurqb"></span> <span class="svelte-1mjurqb"></span> <span class="svelte-1mjurqb"></span></div>'),ws=I('<div class="content svelte-1mjurqb"><!> <!> <!> <!></div>'),ks=I('<div class="content system-message svelte-1mjurqb"><!></div>'),xs=I('<div class="timestamp svelte-1mjurqb"> </div>'),As=I('<div class="image-modal-overlay svelte-1mjurqb" role="dialog" aria-modal="true" tabindex="0"><div class="image-modal-content svelte-1mjurqb" role="presentation"><button class="close-modal svelte-1mjurqb" aria-label="Close image preview">×</button> <img class="svelte-1mjurqb"> <div class="modal-caption svelte-1mjurqb"> </div></div></div>'),Ms=I("<div><!> <!></div> <!>",1);function Is(s,t){Re(t,!1);const o=ne(),_=ne();let a=ae(t,"message",8),f=ae(t,"isStreaming",8,!1),i=ae(t,"scrollToBottom",8,!1),r=ne(!1),O=ne(""),v=ne(""),n=ne();Ye(()=>{if(i()&&e(n)){const E=e(n).parentElement;E&&(E.scrollTop=E.scrollHeight)}});function z(E,C=2){if(E===0)return"0 Bytes";const V=1024,Q=C<0?0:C,W=["Bytes","KB","MB","GB","TB"],J=Math.floor(Math.log(E)/Math.log(V));return parseFloat((E/Math.pow(V,J)).toFixed(Q))+" "+W[J]}function g(E,C="Preview image"){m(O,E),m(v,C),m(r,!0)}function p(){m(r,!1)}Qe(()=>xt(a()),()=>{m(o,new Date(a().timestamp).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"}))}),Qe(()=>xt(a()),()=>{m(_,`message ${a().role}`)}),_t(),Ke();var h=Ms(),j=ve(h),S=c(j);{var K=E=>{var C=ms(),V=c(C),Q=c(V),W=c(Q,!0);l(Q),l(V);var J=k(V,2);{var re=ee=>{var se=fs();Se(se,5,()=>a().media,Ie,(le,G,ce)=>{var H=fe(),w=ve(H);{var y=M=>{var x=os(),R=c(x);ye(R,"alt",`Image ${ce+1}`),l(x),U(()=>ye(R,"src",e(G).preview)),oe("click",x,()=>{e(G).preview&&g(e(G).preview,`Image ${ce+1}`)}),oe("keydown",x,P=>{if(P.key==="Enter"||P.key===" "){if(P.preventDefault(),!e(G).preview)return;g(e(G).preview,`Image ${ce+1}`)}}),d(M,x)},$=(M,x)=>{{var R=te=>{var ue=rs();U(()=>ye(ue,"src",e(G).preview)),d(te,ue)},P=(te,ue)=>{{var u=T=>{var A=ls();U(()=>ye(A,"src",e(G).preview)),d(T,A)},b=(T,A)=>{{var X=N=>{var de=ps(),be=k(c(de),2),Me=c(be),we=c(Me,!0);l(Me);var Z=k(Me,2);{var L=Ee=>{var Pe=is(),Fe=c(Pe,!0);l(Pe),U(Be=>he(Fe,Be),[()=>z(e(G).size)],pe),d(Ee,Pe)};F(Z,Ee=>{e(G).size&&Ee(L)})}var me=k(Z,2),Ze=c(me);{var et=Ee=>{var Pe=ns(),Fe=c(Pe);l(Pe),U(Be=>he(Fe,`✓ Uploaded to OpenAI (ID: ${Be??""}...)`),[()=>e(G).fileId.substring(0,8)],pe),d(Ee,Pe)},Rt=(Ee,Pe)=>{{var Fe=Le=>{var Xe=fe(),Vt=ve(Xe);{var Ft=De=>{var tt=cs();d(De,tt)},Bt=(De,tt)=>{{var Wt=He=>{var at=ds();d(He,at)},Gt=He=>{var at=vs();d(He,at)};F(De,He=>{a().role==="assistant"?He(Wt):He(Gt,!1)},tt)}};F(Vt,De=>{a().role==="user"?De(Ft):De(Bt,!1)})}d(Le,Xe)},Be=Le=>{var Xe=us();d(Le,Xe)};F(Ee,Le=>{e(G).preview?Le(Fe):Le(Be,!1)},Pe)}};F(Ze,Ee=>{e(G).fileId?Ee(et):Ee(Rt,!1)})}l(me),l(be),l(de),U(()=>he(we,e(G).name||"Document")),d(N,de)};F(T,N=>{e(G).type==="document"&&N(X)},A)}};F(te,T=>{e(G).type==="video"?T(u):T(b,!1)},ue)}};F(M,te=>{e(G).type==="audio"?te(R):te(P,!1)},x)}};F(w,M=>{e(G).type==="image"?M(y):M($,!1)})}d(le,H)}),l(se),d(ee,se)};F(J,ee=>{a().media&&a().media.length>0&&ee(re)})}l(C),U(()=>he(W,a().content)),d(E,C)},Y=(E,C)=>{{var V=W=>{var J=ws(),re=c(J);ot(re,{get content(){return a().content},get scrollToBottom(){return i()}});var ee=k(re,2);{var se=w=>{var y=bs();Se(y,5,()=>a().media,Ie,($,M,x)=>{var R=fe(),P=ve(R);{var te=u=>{var b=gs(),T=c(b);ye(T,"alt",`Generated image ${x+1}`),Oe(2),l(b),U(()=>ye(T,"src",e(M).preview)),oe("click",b,()=>{e(M).preview&&g(e(M).preview,`Generated image ${x+1}`)}),oe("keydown",b,A=>{if(A.key==="Enter"||A.key===" "){if(A.preventDefault(),!e(M).preview)return;g(e(M).preview,`Generated image ${x+1}`)}}),d(u,b)},ue=(u,b)=>{{var T=X=>{var N=hs();U(()=>ye(N,"src",e(M).preview)),d(X,N)},A=(X,N)=>{{var de=be=>{var Me=_s();U(()=>ye(Me,"src",e(M).preview)),d(be,Me)};F(X,be=>{e(M).type==="video"&&be(de)},N)}};F(u,X=>{e(M).type==="audio"?X(T):X(A,!1)},b)}};F(P,u=>{e(M).type==="image"?u(te):u(ue,!1)})}d($,R)}),l(y),d(w,y)};F(ee,w=>{a().media&&a().media.length>0&&w(se)})}var le=k(ee,2);{var G=w=>{var y=ys(),$=k(c(y),2),M=c($);ot(M,{get content(){return a().thinking},scrollToBottom:!1}),l($),l(y),d(w,y)};F(le,w=>{a().thinking&&w(G)})}var ce=k(le,2);{var H=w=>{var y=$s();d(w,y)};F(ce,w=>{f()&&w(H)})}l(J),d(W,J)},Q=(W,J)=>{{var re=ee=>{var se=ks(),le=c(se);ot(le,{get content(){return a().content},get scrollToBottom(){return i()}}),l(se),d(ee,se)};F(W,ee=>{a().role==="system"&&ee(re)},J)}};F(E,W=>{a().role==="assistant"?W(V):W(Q,!1)},C)}};F(S,E=>{a().role==="user"?E(K):E(Y,!1)})}var B=k(S,2);{var q=E=>{var C=xs(),V=c(C,!0);l(C),U(()=>he(V,e(o))),d(E,C)};F(B,E=>{a().role==="user"&&E(q)})}l(j),bt(j,E=>m(n,E),()=>e(n));var D=k(j,2);{var _e=E=>{var C=As(),V=c(C),Q=c(V),W=k(Q,2),J=k(W,2),re=c(J,!0);l(J),l(V),l(C),U(()=>{ye(W,"src",e(O)),ye(W,"alt",e(v)),he(re,e(v))}),oe("click",Q,p),oe("click",V,Mt(()=>{})),oe("keydown",V,Mt(()=>{})),oe("click",C,p),oe("keydown",C,ee=>ee.key==="Escape"&&p()),d(E,C)};F(D,E=>{e(r)&&E(_e)})}U(()=>Ne(j,1,ha(e(_)),"svelte-1mjurqb")),d(s,h),Ve()}var Ss=I('<img class="svelte-ij5ual">'),Es=I('<div class="file-preview svelte-ij5ual"><span class="svelte-ij5ual"> </span></div>'),Cs=I('<div class="media-item svelte-ij5ual"><!> <button type="button" class="remove-media svelte-ij5ual" aria-label="Remove media">&times;</button></div>'),zs=I("<div><!></div>"),Ps=I("<div><!></div>"),qs=I("<div><!></div>"),js=I('<button type="button"> </button>'),Ts=I('<div class="message-input-container svelte-ij5ual"><div class="media-preview svelte-ij5ual"></div> <div class="input-bubble svelte-ij5ual"><div class="input-container svelte-ij5ual"><textarea rows="2" class="svelte-ij5ual"></textarea></div> <div class="actions-bar svelte-ij5ual"><div class="left-actions svelte-ij5ual"><input type="file" id="file-upload" hidden accept="image/*,audio/*,video/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,text/plain,text/csv,application/rtf,text/rtf,application/vnd.oasis.opendocument.text,application/vnd.oasis.opendocument.spreadsheet,application/vnd.oasis.opendocument.presentation" multiple class="svelte-ij5ual"> <!> <!> <!> <!></div> <div class="right-actions svelte-ij5ual"><!></div></div></div> <div class="tools-bar svelte-ij5ual"></div></div>');function Ns(s,t){Re(t,!1);let o=ae(t,"value",12,""),_=ae(t,"placeholder",8,"Send a message..."),a=ae(t,"disabled",8,!1),f=ae(t,"isRecording",8,!1),i=ae(t,"isCapturingVideo",8,!1),r=ae(t,"mediaItems",28,()=>[]),O=ae(t,"tools",24,()=>({}));const v=ht();let n=ne(),z=!1;Ye(()=>(g(),window.addEventListener("resize",g),()=>{window.removeEventListener("resize",g)}));function g(){z=window.innerWidth<768}function p(){e(n)&&(ke(n,e(n).style.height="auto"),ke(n,e(n).style.height=`${Math.min(e(n).scrollHeight,200)}px`))}function h(){a()||!o().trim()&&r().length===0||(v("submit",{content:o().trim(),media:r(),tools:O()}),o(""),e(n)&&ke(n,e(n).style.height="auto"))}function j(x){x.key==="Enter"&&!x.shiftKey&&!z&&(x.preventDefault(),h())}function S(){f()?v("stopAudioCapture"):v("startAudioCapture")}function K(){i()?v("stopVideoCapture"):v("startVideoCapture")}function Y(x){const R=x.target;if(R.files&&R.files.length>0){const P=Array.from(R.files);v("uploadFile",P),R.value=""}}function B(x){const R=!O()[x];v("toggleTool",{tool:x,enabled:R})}Qe(()=>e(n),()=>{e(n)&&p()}),_t(),Ke();var q=Ts(),D=c(q);Se(D,5,r,Ie,(x,R)=>{var P=Cs(),te=c(P);{var ue=T=>{var A=Ss();U(()=>{ye(A,"src",e(R).preview),ye(A,"alt",e(R).name)}),d(T,A)},u=T=>{var A=Es(),X=c(A),N=c(X,!0);l(X),l(A),U(()=>he(N,e(R).name)),d(T,A)};F(te,T=>{e(R).type==="image"&&e(R).preview?T(ue):T(u,!1)})}var b=k(te,2);l(P),oe("click",b,()=>{r(r().filter(T=>T.id!==e(R).id))}),d(x,P)}),l(D);var _e=k(D,2),E=c(_e),C=c(E);fa(C),bt(C,x=>m(n,x),()=>e(n)),l(E);var V=k(E,2),Q=c(V),W=c(Q),J=k(W,2);xe(J,{variant:"icon",size:"sm",get disabled(){return a()},"aria-label":"Upload file",$$events:{click:()=>{var x;return(x=document.getElementById("file-upload"))==null?void 0:x.click()}},children:(x,R)=>{Ht(x,{size:18})},$$slots:{default:!0}});var re=k(J,2);const ee=pe(()=>a()||f()),se=pe(()=>f()?"Stop recording":"Start recording");xe(re,{variant:"icon",size:"sm",get disabled(){return e(ee)},get"aria-label"(){return e(se)},$$events:{click:S},children:(x,R)=>{var P=zs();let te;var ue=c(P);Fa(ue,{size:18}),l(P),U(u=>te=Ne(P,1,"svelte-ij5ual",null,te,u),[()=>({active:f()})],pe),d(x,P)},$$slots:{default:!0}});var le=k(re,2);const G=pe(()=>a()||f()),ce=pe(()=>i()?"Stop video capture":"Start video capture");xe(le,{variant:"icon",size:"sm",get disabled(){return e(G)},get"aria-label"(){return e(ce)},$$events:{click:K},children:(x,R)=>{var P=Ps();let te;var ue=c(P);Wa(ue,{size:18}),l(P),U(u=>te=Ne(P,1,"svelte-ij5ual",null,te,u),[()=>({active:i()})],pe),d(x,P)},$$slots:{default:!0}});var H=k(le,2);xe(H,{variant:"icon",size:"sm","aria-label":"Toggle web search",$$events:{click:()=>B("search")},children:(x,R)=>{var P=qs();let te;var ue=c(P);Ra(ue,{size:18}),l(P),U(u=>te=Ne(P,1,"svelte-ij5ual",null,te,u),[()=>({active:O().search})],pe),d(x,P)},$$slots:{default:!0}}),l(Q);var w=k(Q,2),y=c(w);const $=pe(()=>a()||!o().trim()&&r().length===0);xe(y,{variant:"icon",size:"sm",get disabled(){return e($)},class:"send-button","aria-label":"Send message",$$events:{click:h},children:(x,R)=>{Ka(x,{size:20,strokeWidth:2.5})},$$slots:{default:!0}}),l(w),l(V),l(_e);var M=k(_e,2);Se(M,5,()=>Object.entries(O()),Ie,(x,R)=>{let P=()=>e(R)[0],te=()=>e(R)[1];var ue=fe(),u=ve(ue);{var b=T=>{var A=js();let X;var N=c(A,!0);l(A),U(de=>{X=Ne(A,1,"tool-button svelte-ij5ual",null,X,de),ye(A,"aria-label",`Toggle ${P()??""}`),he(N,P())},[()=>({enabled:te()})],pe),oe("click",A,()=>B(P())),d(T,A)};F(u,T=>{P()!=="search"&&T(b)})}d(x,ue)}),l(M),l(q),U(()=>{ye(C,"placeholder",_()),C.disabled=a()}),We(C,o),oe("keydown",C,j),oe("input",C,p),oe("change",W,Y),d(s,q),Ve()}var Os=I('<span class="success-message svelte-8a76oy">API keys saved successfully!</span>'),Ls=I('<span class="error-message svelte-8a76oy"> </span>'),Ds=I('<div class="settings-overlay svelte-8a76oy" role="dialog" aria-modal="true" tabindex="-1"><div class="settings-modal svelte-8a76oy"><div class="settings-header svelte-8a76oy"><h2 class="svelte-8a76oy">Settings</h2> <!></div> <div class="settings-content svelte-8a76oy"><section class="svelte-8a76oy"><h3 class="svelte-8a76oy">API Keys</h3> <p class="description svelte-8a76oy">Add your API keys to use different LLM providers. Keys are stored locally in your browser and never sent out anywhere.</p> <div class="api-keys-form svelte-8a76oy"><div class="form-group svelte-8a76oy"><label for="anthropic-key" class="svelte-8a76oy">Anthropic API Key</label> <input id="anthropic-key" type="password" placeholder="Enter Anthropic API key" autocomplete="off" class="svelte-8a76oy"></div> <div class="form-group svelte-8a76oy"><label for="openai-key" class="svelte-8a76oy">OpenAI API Key</label> <input id="openai-key" type="password" placeholder="Enter OpenAI API key" autocomplete="off" class="svelte-8a76oy"></div> <div class="form-group svelte-8a76oy"><label for="google-key" class="svelte-8a76oy">Google AI API Key</label> <input id="google-key" type="password" placeholder="Enter Google AI API key" autocomplete="off" class="svelte-8a76oy"></div> <div class="form-group svelte-8a76oy"><label for="ollama-host" class="svelte-8a76oy">Ollama Host</label> <input id="ollama-host" type="text" placeholder="http://localhost:11434" autocomplete="off" class="svelte-8a76oy"> <small class="svelte-8a76oy">Example: http://localhost:11434</small></div></div> <div class="form-actions svelte-8a76oy"><!> <!> <!></div></section></div></div></div>');function Hs(s,t){Re(t,!1);const[o,_]=yt(),a=()=>Te(vt,"$settingsStore",o);let f=ae(t,"isOpen",8,!1);const i=ht();let r=ne({anthropic:"",openai:"",google:"",ollamaHost:"http://localhost:11434"}),O=ne(!1),v=ne(!1),n=ne("");Ye(()=>{console.log("Settings component mounted, current settingsStore value:",a());const S=a().apiKeys||{};console.log("Stored API keys from settings store:",S),m(r,{anthropic:S.anthropic||"",openai:S.openai||"",google:S.google||"",ollamaHost:S.ollamaHost||"http://localhost:11434"}),console.log("Initialized API key form with:",e(r))});function z(){i("close")}async function g(){var S;m(O,!0),m(v,!1),m(n,"");try{if(console.log("Saving API keys to settingsStore:",e(r)),e(r).openai){console.log("EXACT OPENAI KEY BEING SAVED: ",e(r).openai),console.log(`OpenAI key before saving: length=${e(r).openai.length}, starts with=${e(r).openai.substring(0,4)}`);const K=[...e(r).openai.substring(0,10)].map(Y=>Y.charCodeAt(0));console.log(`First 10 character codes: ${K.join(", ")}`)}if(await vt.updateApiKeys({anthropic:e(r).anthropic,openai:e(r).openai,google:e(r).google,ollamaHost:e(r).ollamaHost||"http://localhost:11434"}),console.log("API keys saved. Current settingsStore value:",a()),(S=a().apiKeys)!=null&&S.openai){console.log("EXACT OPENAI KEY AFTER SAVING: ",a().apiKeys.openai),console.log(`OpenAI key after saving: length=${a().apiKeys.openai.length}, starts with=${a().apiKeys.openai.substring(0,4)}`);const K=[...a().apiKeys.openai.substring(0,10)].map(Y=>Y.charCodeAt(0));console.log(`First 10 character codes after saving: ${K.join(", ")}`)}m(v,!0),console.log("API keys saved successfully"),setTimeout(()=>{m(v,!1)},3e3)}catch(K){console.error("Failed to save API keys:",K),m(n,K instanceof Error?K.message:"Unknown error")}finally{m(O,!1)}}Ke();var p=fe(),h=ve(p);{var j=S=>{var K=Ds(),Y=c(K),B=c(Y),q=k(c(B),2);xe(q,{variant:"icon","aria-label":"Close settings",$$events:{click:z},children:($,M)=>{Kt($,{size:20})},$$slots:{default:!0}}),l(B);var D=k(B,2),_e=c(D),E=k(c(_e),4),C=c(E),V=k(c(C),2);Je(V),l(C);var Q=k(C,2),W=k(c(Q),2);Je(W),l(Q);var J=k(Q,2),re=k(c(J),2);Je(re),l(J);var ee=k(J,2),se=k(c(ee),2);Je(se),Oe(2),l(ee),l(E);var le=k(E,2),G=c(le);xe(G,{variant:"primary",get disabled(){return e(O)},$$events:{click:g},children:($,M)=>{Oe();var x=Xt();U(()=>he(x,e(O)?"Saving...":"Save API Keys")),d($,x)},$$slots:{default:!0}});var ce=k(G,2);{var H=$=>{var M=Os();d($,M)};F(ce,$=>{e(v)&&$(H)})}var w=k(ce,2);{var y=$=>{var M=Ls(),x=c(M,!0);l(M),U(()=>he(x,e(n))),d($,M)};F(w,$=>{e(n)&&$(y)})}l(le),l(_e),l(D),l(Y),l(K),We(V,()=>e(r).anthropic,$=>ke(r,e(r).anthropic=$)),We(W,()=>e(r).openai,$=>ke(r,e(r).openai=$)),We(re,()=>e(r).google,$=>ke(r,e(r).google=$)),We(se,()=>e(r).ollamaHost,$=>ke(r,e(r).ollamaHost=$)),oe("click",K,Oa(z)),oe("keydown",K,$=>$.key==="Escape"&&z()),d(S,K)};F(h,S=>{f()&&S(j)})}d(s,p),Ve(),_()}var Ks=I('<div class="sidebar-backdrop svelte-1b4tzcm" role="button" tabindex="0" aria-label="Close sidebar"></div>'),Rs=I('<div class="empty-state svelte-1b4tzcm"><h2 class="svelte-1b4tzcm">Start a new conversation</h2> <p class="svelte-1b4tzcm">Send a message to start chatting with the AI assistant.</p> <div class="feature-highlights svelte-1b4tzcm"><div class="feature svelte-1b4tzcm"><!> <span>Attach files for analysis</span></div> <div class="feature svelte-1b4tzcm"><!> <span>Vision support for images</span></div></div></div>'),Vs=I('<div class="settings-portal svelte-1b4tzcm"><!></div>'),Fs=I('<div class="chat-container svelte-1b4tzcm"><!> <!> <main class="chat-main svelte-1b4tzcm"><header class="chat-header svelte-1b4tzcm"><!> <h1 class="chat-title svelte-1b4tzcm"> </h1> <!></header> <div class="chat-messages svelte-1b4tzcm"><!></div> <div class="input-container svelte-1b4tzcm"><!></div></main></div> <!>',1);function ao(s,t){Re(t,!1);const[o,_]=yt(),a=()=>Te(Nt,"$activeChat",o),f=()=>Te(vt,"$settingsStore",o);let i=ne(!1),r=ne(!0),O=ne(""),v=ne(!1),n=ne(!1),z=ne([]),g=ne({search:!1}),p=ne(),h=ne(!1);function j(){m(i,window.innerWidth<768),e(i)?m(r,!1):m(r,!0)}Ye(()=>{j(),window.addEventListener("resize",j);function u(){document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`)}return u(),window.addEventListener("resize",u),()=>{window.removeEventListener("resize",j),window.removeEventListener("resize",u)}});function S(){m(r,!e(r))}async function K({detail:u}){var de,be,Me;if(!a())return;const b=a().model.provider;if(console.log("Current settings store state:",f()),b==="openai"&&!((de=f().apiKeys)!=null&&de.openai)){console.warn("OpenAI API key not set, opening settings dialog"),m(h,!0),alert("Please set your OpenAI API key in Settings to use this model.");return}else if(b==="anthropic"&&!((be=f().apiKeys)!=null&&be.anthropic)){console.warn("Anthropic API key not set, opening settings dialog"),m(h,!0),alert("Please set your Anthropic API key in Settings to use this model.");return}else if(b==="google"&&!((Me=f().apiKeys)!=null&&Me.google)){console.warn("Google API key not set, opening settings dialog"),m(h,!0),alert("Please set your Google API key in Settings to use this model.");return}const{content:T,media:A,tools:X}=u;console.log("Media items in submission:",A),await ie.addMessage(a().id,{role:"user",content:T,media:A}),m(O,""),m(z,[]),setTimeout(()=>{e(p)&&ke(p,e(p).scrollTop=e(p).scrollHeight)},100);const N=await ie.addMessage(a().id,{role:"assistant",content:""});m(v,!0),m(n,!0);try{const we=a().messages.slice(0,-1);console.log("Sending messages to LLM with media:",we);const Z=a().model.id;if(b==="anthropic")await Ma(Z,we,L=>{ie.updateMessage(a().id,N,{content:L})},()=>{m(v,!1),m(n,!1),setTimeout(()=>{e(p)&&ke(p,e(p).scrollTop=e(p).scrollHeight)},100)},L=>{console.error("Error generating response:",L),ie.updateMessage(a().id,N,{content:`Error generating response: – ${L.message}`}),m(v,!1),m(n,!1)},L=>{ie.updateMessage(a().id,N,{thinking:L})});else if(b==="openai")if(e(n))await Ia(Z,we,L=>{ie.updateMessage(a().id,N,{content:L})},()=>{m(v,!1),m(n,!1),setTimeout(()=>{e(p)&&ke(p,e(p).scrollTop=e(p).scrollHeight)},100)},L=>{console.error("Error generating response from OpenAI:",L);const me=L.message||"An unknown error occurred";ie.updateMessage(a().id,N,{content:`Error: ${me}`}),m(v,!1),m(n,!1)});else try{const L=await Sa(Z,we);ie.updateMessage(a().id,N,{content:L}),m(v,!1)}catch(L){console.error("Error generating non-streaming response from OpenAI:",L);const me=L.message||"An unknown error occurred";throw ie.updateMessage(a().id,N,{content:`Error: ${me}`}),m(v,!1),L}else if(b==="google")await Ea(Z,we,(L,me)=>{ie.updateMessage(a().id,N,{content:L,media:me})},()=>{m(v,!1),m(n,!1),setTimeout(()=>{e(p)&&ke(p,e(p).scrollTop=e(p).scrollHeight)},100)},L=>{console.error("Error generating response from Google:",L);const me=L.message||"An unknown error occurred";ie.updateMessage(a().id,N,{content:`Error: ${me}`}),m(v,!1),m(n,!1)},L=>{ie.updateMessage(a().id,N,{thinking:L})});else if(b==="ollama")try{await Ca(Z,we,L=>{ie.updateMessage(a().id,N,{content:L})},()=>{m(v,!1),m(n,!1),setTimeout(()=>{e(p)&&ke(p,e(p).scrollTop=e(p).scrollHeight)},100)},L=>{console.error("Error generating response from Ollama:",L);const me=L.message||"An unknown error occurred";ie.updateMessage(a().id,N,{content:`Error connecting to Ollama: ${me}. Make sure Ollama is running locally.`}),m(v,!1),m(n,!1)})}catch(L){throw console.error("Error generating response from Ollama:",L),L}else{let L="";const me="This is a placeholder response. Please set up your API keys in Settings to use actual LLM services.".split(" ");for(const Ze of me)await new Promise(et=>setTimeout(et,50)),L+=Ze+" ",ie.updateMessage(a().id,N,{content:L.trim()});m(v,!1),m(n,!1)}}catch(we){if(console.error("Error generating response:",we),e(v)){const Z=we.message||"An unknown error occurred";ie.updateMessage(a().id,N,{content:`Error: ${Z}`}),m(v,!1),m(n,!1)}}}function Y(u){u.forEach(async b=>{const T=xa(),A=b.name,X=b.size;let N="other",de,be;console.log(`Processing file: ${A}, type: ${b.type}, size: ${X} bytes`);const Me=Z=>{var L;if(Z.type.includes("pdf")||Z.type.includes("word")||Z.type.includes("excel")||Z.type.includes("spreadsheet")||Z.type.includes("presentation")||Z.type.includes("officedocument")||Z.type.includes("application/rtf")||Z.type.includes("text/rtf"))return!0;if(!Z.type||Z.type==="application/octet-stream"){const me=(L=A.split(".").pop())==null?void 0:L.toLowerCase();return["pdf","doc","docx","xls","xlsx","ppt","pptx","rtf","odt","ods","odp","csv"].includes(me||"")}return!1};if(b.type.startsWith("image/")){N="image";try{de=await B(b),console.log(`Created data URL for image ${A} (length: ${de.length} chars)`)}catch(Z){console.error(`Failed to create data URL for ${A}:`,Z)}}else if(b.type.startsWith("audio/"))N="audio";else if(b.type.startsWith("video/"))N="video";else if(b.type.startsWith("text/"))N="text";else if(Me(b)){if(N="document",a()&&a().model.provider==="openai")try{be=await Aa(b),console.log(`Document ${A} uploaded to OpenAI with ID: ${be}`)}catch(Z){console.error(`Failed to upload document to OpenAI: ${Z.message}`),alert(`Failed to upload document to OpenAI: ${Z.message}`)}try{de=await B(b),console.log(`Created data URL for document ${A}, mime type: ${b.type}`),console.log(`Document data URL length: ${de.length} chars`),X>5*1024*1024&&console.warn(`Warning: Large document (${(X/(1024*1024)).toFixed(2)}MB) may cause issues with API limits`)}catch(Z){console.error(`Failed to create data URL for ${A}:`,Z)}}const we={id:T,type:N,name:A,preview:de,size:X,timestamp:Date.now(),fileId:be};console.log(`Adding media item: ${N} ${A}`),m(z,[...e(z),we])})}async function B(u){return new Promise((b,T)=>{const A=new FileReader;A.onload=()=>{const X=A.result;b(X)},A.onerror=X=>{console.error("Error reading file:",X),T(X)},A.readAsDataURL(u)})}function q({detail:u}){const{tool:b,enabled:T}=u;m(g,{...e(g),[b]:T})}function D(){console.log("Start audio capture")}function _e(){console.log("Stop audio capture")}function E(){console.log("Start video capture")}function C(){console.log("Stop video capture")}Ke();var V=Fs(),Q=ve(V),W=c(Q);ss(W,{get isMobile(){return e(i)},get isExpanded(){return e(r)},$$events:{toggleSidebar:({detail:u})=>m(r,u)}});var J=k(W,2);{var re=u=>{var b=Ks();oe("click",b,()=>m(r,!1)),oe("keydown",b,T=>T.key==="Escape"&&m(r,!1)),d(u,b)};F(J,u=>{e(i)&&e(r)&&u(re)})}var ee=k(J,2),se=c(ee),le=c(se);{var G=u=>{xe(u,{variant:"icon","aria-label":"Open menu",$$events:{click:S},children:(b,T)=>{Dt(b,{size:20})},$$slots:{default:!0}})};F(le,u=>{e(i)&&u(G)})}var ce=k(le,2),H=c(ce,!0);l(ce);var w=k(ce,2);xe(w,{variant:"icon","aria-label":"Open settings",$$events:{click:()=>m(h,!0)},children:(u,b)=>{Ba(u,{size:20})},$$slots:{default:!0}}),l(se);var y=k(se,2),$=c(y);{var M=u=>{var b=fe(),T=ve(b);Se(T,1,()=>a().messages,Ie,(A,X,N)=>{const de=pe(()=>e(n)&&N===a().messages.length-1&&e(X).role==="assistant"),be=pe(()=>N===a().messages.length-1);Is(A,{get message(){return e(X)},get isStreaming(){return e(de)},get scrollToBottom(){return e(be)}})}),d(u,b)},x=u=>{var b=Rs(),T=k(c(b),4),A=c(T),X=c(A);Ht(X,{size:16}),Oe(2),l(A);var N=k(A,2),de=c(N);Va(de,{size:16}),Oe(2),l(N),l(T),l(b),d(u,b)};F($,u=>{a()&&a().messages.length>0?u(M):u(x,!1)})}l(y),bt(y,u=>m(p,u),()=>e(p));var R=k(y,2),P=c(R);Ns(P,{get tools(){return e(g)},get disabled(){return e(v)},placeholder:"Send a message...",get value(){return e(O)},set value(u){m(O,u)},get mediaItems(){return e(z)},set mediaItems(u){m(z,u)},$$events:{submit:K,uploadFile:u=>Y(u.detail),toggleTool:q,startAudioCapture:D,stopAudioCapture:_e,startVideoCapture:E,stopVideoCapture:C},$$legacy:!0}),l(R),l(ee),l(Q);var te=k(Q,2);{var ue=u=>{var b=Vs(),T=c(b);Hs(T,{isOpen:!0,$$events:{close:()=>m(h,!1)}}),l(b),d(u,b)};F(te,u=>{e(h)&&u(ue)})}U(()=>{var u;return he(H,((u=a())==null?void 0:u.model.name)||"AI Assistant")}),d(s,V),Ve(),_()}export{ao as component};
