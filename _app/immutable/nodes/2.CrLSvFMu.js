import{a as Ut,n as Yt,b as u,c as fe,t as I,d as Xt}from"../chunks/CD-cSNpP.js";import{i as Re}from"../chunks/DSKYDh3O.js";import{v as It,b as St,s as Ue,h as ge,j as Et,a as it,G as e,aa as ue,c as Jt,r as $t,d as Ye,g as Te,m as Qt,e as pt,f as ft,p as Ct,aD as st,t as Pt,a7 as Zt,y as ct,aE as mt,aF as wt,aG as gt,B as ea,$ as kt,aH as qt,a4 as zt,aI as ta,aJ as aa,q as sa,aK as oa,aL as Tt,aM as ra,k as la,E as na,aN as ia,aO as ca,N as Nt,a6 as va,a5 as da,w as Ve,V as c,X as x,T as Y,z as Fe,W as l,S as ve,aP as ht,aQ as ie,al as Qe,aR as Je,aS as _t,D as _,aT as Ne,P as xt,aU as we}from"../chunks/BSv_i5Hy.js";import{s as he}from"../chunks/XUjQEjo_.js";import{i as G}from"../chunks/Cec3cEQU.js";import{l as ua,m as pa,o as se,p as fa}from"../chunks/Bl1F-iLh.js";import{i as ma,l as ye,p as te,s as Ce,b as bt}from"../chunks/DYD2hZ7I.js";import{a as je,s as yt}from"../chunks/HG7v26tk.js";import{s as Ae,b as vt,C as ga,d as Le,a as be,e as jt,c as ne,f as ha,r as We}from"../chunks/uxZwVYDM.js";import{i as _a,o as ba,g as ya,b as $a,l as wa,c as ka,s as dt,v as xa,u as Aa,e as Ma,f as Ia,h as Sa,j as Ea,k as Ca}from"../chunks/BFkVdgW4.js";import{M as ot}from"../chunks/CoxQhQk-.js";function Ie(s,t){return t}function Pa(s,t,r,$){for(var a=[],m=t.length,n=0;n<m;n++)aa(t[n].e,a,!0);var o=m>0&&a.length===0&&r!==null;if(o){var z=r.parentNode;sa(z),z.append(r),$.clear(),ze(s,t[0].prev,t[m-1].next)}oa(a,()=>{for(var p=0;p<m;p++){var i=t[p];o||($.delete(i.k),ze(s,i.prev,i.next)),Tt(i.e,!o)}})}function Se(s,t,r,$,a,m=null){var n=s,o={flags:t,items:new Map,first:null},z=(t&qt)!==0;if(z){var p=s;n=ge?Ue(Et(p)):p.appendChild(It())}ge&&it();var i=null,S=!1,y=ue(()=>{var g=r();return zt(g)?g:g==null?[]:Pt(g)});St(()=>{var g=e(y),w=g.length;if(S&&w===0)return;S=w===0;let q=!1;if(ge){var M=n.data===Jt;M!==(w===0)&&(n=$t(),Ue(n),Ye(!1),q=!0)}if(ge){for(var j=null,F,B=0;B<w;B++){if(Te.nodeType===8&&Te.data===Qt){n=Te,q=!0,Ye(!1);break}var C=g[B],L=$(C,B);F=Lt(Te,o,j,null,C,L,B,a,t,r),o.items.set(L,F),j=F}w>0&&Ue($t())}ge||qa(g,o,n,a,t,$,r),m!==null&&(w===0?i?pt(i):i=ft(()=>m(n)):i!==null&&Ct(i,()=>{i=null})),q&&Ye(!0),e(y)}),ge&&(n=Te)}function qa(s,t,r,$,a,m,n){var X,ae,ce,U;var o=(a&ta)!==0,z=(a&(mt|gt))!==0,p=s.length,i=t.items,S=t.first,y=S,g,w=null,q,M=[],j=[],F,B,C,L;if(o)for(L=0;L<p;L+=1)F=s[L],B=m(F,L),C=i.get(B),C!==void 0&&((X=C.a)==null||X.measure(),(q??(q=new Set)).add(C));for(L=0;L<p;L+=1){if(F=s[L],B=m(F,L),C=i.get(B),C===void 0){var de=y?y.e.nodes_start:r;w=Lt(de,t,w,w===null?t.first:w.next,F,B,L,$,a,n),i.set(B,w),M=[],j=[],y=w.next;continue}if(z&&za(C,F,L,a),(C.e.f&st)!==0&&(pt(C.e),o&&((ae=C.a)==null||ae.unfix(),(q??(q=new Set)).delete(C))),C!==y){if(g!==void 0&&g.has(C)){if(M.length<j.length){var E=j[0],P;w=E.prev;var K=M[0],Z=M[M.length-1];for(P=0;P<M.length;P+=1)At(M[P],E,r);for(P=0;P<j.length;P+=1)g.delete(j[P]);ze(t,K.prev,Z.next),ze(t,w,K),ze(t,Z,E),y=E,w=Z,L-=1,M=[],j=[]}else g.delete(C),At(C,y,r),ze(t,C.prev,C.next),ze(t,C,w===null?t.first:w.next),ze(t,w,C),w=C;continue}for(M=[],j=[];y!==null&&y.k!==B;)(y.e.f&st)===0&&(g??(g=new Set)).add(y),j.push(y),y=y.next;if(y===null)continue;C=y}M.push(C),w=C,y=C.next}if(y!==null||g!==void 0){for(var W=g===void 0?[]:Pt(g);y!==null;)(y.e.f&st)===0&&W.push(y),y=y.next;var J=W.length;if(J>0){var oe=(a&qt)!==0&&p===0?r:null;if(o){for(L=0;L<J;L+=1)(ce=W[L].a)==null||ce.measure();for(L=0;L<J;L+=1)(U=W[L].a)==null||U.fix()}Pa(t,W,oe,i)}}o&&Zt(()=>{var re;if(q!==void 0)for(C of q)(re=C.a)==null||re.apply()}),ct.first=t.first&&t.first.e,ct.last=w&&w.e}function za(s,t,r,$){($&mt)!==0&&wt(s.v,t),($&gt)!==0?wt(s.i,r):s.i=r}function Lt(s,t,r,$,a,m,n,o,z,p){var i=(z&mt)!==0,S=(z&ra)===0,y=i?S?ea(a):kt(a):a,g=(z&gt)===0?n:kt(n),w={i:g,v:y,k:m,a:null,e:null,prev:r,next:$};try{return w.e=ft(()=>o(s,y,g,p),ge),w.e.prev=r&&r.e,w.e.next=$&&$.e,r===null?t.first=w:(r.next=w,r.e.next=w.e),$!==null&&($.prev=w,$.e.prev=w.e),w}finally{}}function At(s,t,r){for(var $=s.next?s.next.e.nodes_start:r,a=t?t.e.nodes_start:r,m=s.e.nodes_start;m!==$;){var n=la(m);a.before(m),m=n}}function ze(s,t,r){t===null?s.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}function Ta(s,t,r,$,a,m){let n=ge;ge&&it();var o,z,p=null;ge&&Te.nodeType===1&&(p=Te,it());var i=ge?Te:s,S;St(()=>{const y=t()||null;var g=ia;y!==o&&(S&&(y===null?Ct(S,()=>{S=null,z=null}):y===z?pt(S):Tt(S)),y&&y!==z&&(S=ft(()=>{if(p=ge?p:document.createElementNS(g,y),Ut(p,p),$){ge&&ua(y)&&p.append(document.createComment(""));var w=ge?Et(p):p.appendChild(It());ge&&(w===null?Ye(!1):Ue(w)),$(p,w)}ct.nodes_end=p,i.before(p)})),o=y,o&&(z=o))},na),n&&(Ye(!0),Ue(i))}function Ke(s,t,r=t){var $=ca();pa(s,"input",a=>{var m=a?s.defaultValue:s.value;if(m=rt(s)?lt(m):m,r(m),$&&m!==(m=t())){var n=s.selectionStart,o=s.selectionEnd;s.value=m??"",o!==null&&(s.selectionStart=n,s.selectionEnd=Math.min(o,s.value.length))}}),(ge&&s.defaultValue!==s.value||Nt(t)==null&&s.value)&&r(rt(s)?lt(s.value):s.value),va(()=>{var a=t();rt(s)&&a===lt(s.value)||s.type==="date"&&!a&&!s.value||a!==s.value&&(s.value=a??"")})}function rt(s){var t=s.type;return t==="number"||t==="range"}function lt(s){return s===""?null:+s}function ut(s,t,r){if(s.multiple)return ja(s,t);for(var $ of s.options){var a=Ot($);if(ma(a,t)){$.selected=!0;return}}(!r||t!==void 0)&&(s.selectedIndex=-1)}function Na(s,t){let r=!0;da(()=>{t&&ut(s,Nt(t),r),r=!1;var $=new MutationObserver(()=>{var a=s.__value;ut(s,a)});return $.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{$.disconnect()}})}function ja(s,t){for(var r of s.options)r.selected=~t.indexOf(Ot(r))}function Ot(s){return"__value"in s?s.__value:s.value}function La(s){return function(...t){var r=t[0];r.target===this&&(s==null||s.apply(this,t))}}function Mt(s){return function(...t){var r=t[0];return r.stopPropagation(),s==null?void 0:s.apply(this,t)}}function nt(s,t){var m;var r=(m=s.$$events)==null?void 0:m[t.type],$=zt(r)?r.slice():r==null?[]:[r];for(var a of $)a.call(this,t)}/**
 * @license lucide-svelte v0.479.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 */const Oa={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var Ha=Yt("<svg><!><!></svg>");function Pe(s,t){const r=ye(t,["children","$$slots","$$events","$$legacy"]),$=ye(r,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);Ve(t,!1);let a=te(t,"name",8,void 0),m=te(t,"color",8,"currentColor"),n=te(t,"size",8,24),o=te(t,"strokeWidth",8,2),z=te(t,"absoluteStrokeWidth",8,!1),p=te(t,"iconNode",24,()=>[]);const i=(...q)=>q.filter((M,j,F)=>!!M&&F.indexOf(M)===j).join(" ");Re();var S=Ha();let y;var g=c(S);Se(g,1,p,Ie,(q,M)=>{let j=()=>e(M)[0],F=()=>e(M)[1];var B=fe(),C=ve(B);Ta(C,j,!0,(L,de)=>{let E;Y(()=>E=vt(L,E,{...F()}))}),u(q,B)});var w=x(g);Ae(w,t,"default",{}),l(S),Y((q,M)=>y=vt(S,y,{...Oa,...$,width:n(),height:n(),stroke:m(),"stroke-width":q,class:M}),[()=>z()?Number(o())*24/Number(n()):o(),()=>i("lucide-icon","lucide",a()?`lucide-${a()}`:"",r.class)],ue),u(s,S),Fe()}function Da(s,t){const r=ye(t,["children","$$slots","$$events","$$legacy"]);Pe(s,Ce({name:"chevron-left"},()=>r,{iconNode:[["path",{d:"m15 18-6-6 6-6"}]],children:(a,m)=>{var n=fe(),o=ve(n);Ae(o,t,"default",{}),u(a,n)},$$slots:{default:!0}}))}function Ka(s,t){const r=ye(t,["children","$$slots","$$events","$$legacy"]);Pe(s,Ce({name:"globe"},()=>r,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"}],["path",{d:"M2 12h20"}]],children:(a,m)=>{var n=fe(),o=ve(n);Ae(o,t,"default",{}),u(a,n)},$$slots:{default:!0}}))}function Ra(s,t){const r=ye(t,["children","$$slots","$$events","$$legacy"]);Pe(s,Ce({name:"image"},()=>r,{iconNode:[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}],["circle",{cx:"9",cy:"9",r:"2"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"}]],children:(a,m)=>{var n=fe(),o=ve(n);Ae(o,t,"default",{}),u(a,n)},$$slots:{default:!0}}))}function Va(s,t){const r=ye(t,["children","$$slots","$$events","$$legacy"]);Pe(s,Ce({name:"mic"},()=>r,{iconNode:[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22"}]],children:(a,m)=>{var n=fe(),o=ve(n);Ae(o,t,"default",{}),u(a,n)},$$slots:{default:!0}}))}function Ht(s,t){const r=ye(t,["children","$$slots","$$events","$$legacy"]);Pe(s,Ce({name:"notebook-pen"},()=>r,{iconNode:[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4"}],["path",{d:"M2 6h4"}],["path",{d:"M2 10h4"}],["path",{d:"M2 14h4"}],["path",{d:"M2 18h4"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"}]],children:(a,m)=>{var n=fe(),o=ve(n);Ae(o,t,"default",{}),u(a,n)},$$slots:{default:!0}}))}function Dt(s,t){const r=ye(t,["children","$$slots","$$events","$$legacy"]);Pe(s,Ce({name:"paperclip"},()=>r,{iconNode:[["path",{d:"M13.234 20.252 21 12.3"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486"}]],children:(a,m)=>{var n=fe(),o=ve(n);Ae(o,t,"default",{}),u(a,n)},$$slots:{default:!0}}))}function Fa(s,t){const r=ye(t,["children","$$slots","$$events","$$legacy"]);Pe(s,Ce({name:"send"},()=>r,{iconNode:[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]],children:(a,m)=>{var n=fe(),o=ve(n);Ae(o,t,"default",{}),u(a,n)},$$slots:{default:!0}}))}function Ba(s,t){const r=ye(t,["children","$$slots","$$events","$$legacy"]);Pe(s,Ce({name:"settings"},()=>r,{iconNode:[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}],["circle",{cx:"12",cy:"12",r:"3"}]],children:(a,m)=>{var n=fe(),o=ve(n);Ae(o,t,"default",{}),u(a,n)},$$slots:{default:!0}}))}function Ga(s,t){const r=ye(t,["children","$$slots","$$events","$$legacy"]);Pe(s,Ce({name:"video"},()=>r,{iconNode:[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2"}]],children:(a,m)=>{var n=fe(),o=ve(n);Ae(o,t,"default",{}),u(a,n)},$$slots:{default:!0}}))}function Kt(s,t){const r=ye(t,["children","$$slots","$$events","$$legacy"]);Pe(s,Ce({name:"x"},()=>r,{iconNode:[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]],children:(a,m)=>{var n=fe(),o=ve(n);Ae(o,t,"default",{}),u(a,n)},$$slots:{default:!0}}))}var Wa=I('<div class="spinner svelte-1pi70xe"></div>'),Ua=I("<button><!> <!></button>");function xe(s,t){const r=ye(t,["children","$$slots","$$events","$$legacy"]),$=ye(r,["type","variant","size","disabled","loading","fullWidth"]);let a=te(t,"type",8,"button"),m=te(t,"variant",8,"primary"),n=te(t,"size",8,"md"),o=te(t,"disabled",8,!1),z=te(t,"loading",8,!1),p=te(t,"fullWidth",8,!1);var i=Ua();let S;var y=c(i);{var g=q=>{var M=Wa();u(q,M)};G(y,q=>{z()&&q(g)})}var w=x(y,2);Ae(w,t,"default",{}),l(i),Y(q=>S=vt(i,S,{type:a(),class:`button ${m()??""} ${n()??""} ${(p()?"full-width":"")??""}`,disabled:o(),...$,[ga]:q},"svelte-1pi70xe"),[()=>({loading:z()})],ue),se("click",i,function(q){nt.call(this,t,q)}),se("keydown",i,function(q){nt.call(this,t,q)}),se("keyup",i,function(q){nt.call(this,t,q)}),u(s,i)}var Ya=I('<option class="svelte-1m60q0l"> </option>'),Xa=I('<optgroup label="Local Models" class="svelte-1m60q0l"></optgroup>'),Ja=I('<option class="svelte-1m60q0l"> </option>'),Qa=I('<option class="svelte-1m60q0l"> </option>'),Za=I('<option disabled class="svelte-1m60q0l"> </option>'),es=I('<!> <span class="svelte-1m60q0l">New Chat</span>',1),ts=I('<button type="button"><span class="chat-title svelte-1m60q0l"> </span> <!></button>'),as=I('<aside><div class="sidebar-header svelte-1m60q0l"><div class="logo-container svelte-1m60q0l"><img alt="Gervais Logo" class="logo svelte-1m60q0l"> <h2 class="svelte-1m60q0l">Gervais</h2></div> <!></div> <div class="sidebar-content svelte-1m60q0l"><div class="model-selector svelte-1m60q0l"><select class="select-styled svelte-1m60q0l"><!><optgroup label="OpenAI Models" class="svelte-1m60q0l"></optgroup><optgroup label="Google Models" class="svelte-1m60q0l"></optgroup><optgroup label="Anthropic Models (Disabled)" class="svelte-1m60q0l"></optgroup></select></div> <!> <div class="chats-list svelte-1m60q0l"></div></div></aside>');function ss(s,t){var re;Ve(t,!1);const[r,$]=yt(),a=()=>je(jt,"$activeChat",r),m=()=>je(ka,"$allModelsStore",r),n=()=>je(wa,"$localModelsStore",r),o=()=>je(ne,"$chatStore",r);let z=te(t,"isMobile",8,!1),p=te(t,"isExpanded",8,!0);const i=ht();let S=ie(((re=a())==null?void 0:re.model.id)||"claude-3-5-sonnet");Qe(async()=>{await _a()});function y(){const T=m().find(A=>A.id===e(S));T&&ne.createNewChat(T)}function g(T){ne.selectChat(T),z()&&i("toggleSidebar",!1)}function w(T,A){A.stopPropagation(),ne.deleteChat(T)}function q(T){const A=T.target;if(_(S,A.value),a()){const k=m().find(b=>b.id===e(S));k&&ne.updateChatModel(a().id,k)}}Je(()=>a(),()=>{a()&&_(S,a().model.id)}),_t(),Re();var M=as();let j;var F=c(M),B=c(F),C=c(B);Ne(2),l(B);var L=x(B,2);{var de=T=>{const A=ue(()=>p()?"Collapse sidebar":"Expand sidebar");xe(T,{variant:"icon",size:"sm",class:"collapse-button",get"aria-label"(){return e(A)},$$events:{click:()=>i("toggleSidebar",!p())},children:(k,b)=>{Da(k,{size:20})},$$slots:{default:!0}})};G(L,T=>{z()&&T(de)})}l(F);var E=x(F,2),P=c(E),K=c(P);Na(K,()=>e(S));var Z,W=c(K);{var J=T=>{var A=Xa();Se(A,5,n,Ie,(k,b)=>{var h=Ya(),v={},D=c(h,!0);l(h),Y(()=>{v!==(v=e(b).id)&&(h.value=(h.__value=e(b).id)==null?"":e(b).id),he(D,e(b).name)}),u(k,h)}),l(A),u(T,A)};G(W,T=>{n().length>0&&T(J)})}var oe=x(W);Se(oe,5,()=>ba,Ie,(T,A)=>{var k=Ja(),b={},h=c(k,!0);l(k),Y(()=>{b!==(b=e(A).id)&&(k.value=(k.__value=e(A).id)==null?"":e(A).id),he(h,e(A).name)}),u(T,k)}),l(oe);var X=x(oe);Se(X,5,()=>ya,Ie,(T,A)=>{var k=Qa(),b={},h=c(k,!0);l(k),Y(()=>{b!==(b=e(A).id)&&(k.value=(k.__value=e(A).id)==null?"":e(A).id),he(h,e(A).name)}),u(T,k)}),l(X);var ae=x(X);Se(ae,5,()=>$a,Ie,(T,A)=>{var k=Za(),b={},h=c(k,!0);l(k),Y(()=>{b!==(b=e(A).id)&&(k.value=(k.__value=e(A).id)==null?"":e(A).id),he(h,e(A).name)}),u(T,k)}),l(ae),l(K),l(P);var ce=x(P,2);xe(ce,{variant:"primary",size:"md",fullWidth:!0,class:"new-chat-button",$$events:{click:y},children:(T,A)=>{var k=es(),b=ve(k);Ht(b,{size:16}),Ne(2),u(T,k)},$$slots:{default:!0}});var U=x(ce,2);Se(U,5,()=>o().chats,Ie,(T,A)=>{var k=ts();let b;var h=c(k),v=c(h,!0);l(h);var D=x(h,2);xe(D,{variant:"icon",size:"sm","aria-label":"Delete chat",$$events:{click:V=>w(e(A).id,V)},children:(V,le)=>{Kt(V,{size:16})},$$slots:{default:!0}}),l(k),Y(V=>{b=Le(k,1,"chat-item svelte-1m60q0l",null,b,V),he(v,e(A).title||"New Chat")},[()=>{var V;return{active:e(A).id===((V=a())==null?void 0:V.id)}}],ue),se("click",k,()=>g(e(A).id)),u(T,k)}),l(U),l(E),l(M),Y(T=>{j=Le(M,1,"sidebar svelte-1m60q0l",null,j,T),be(C,"src","/gervais/logo.svg"),Z!==(Z=e(S))&&(K.value=(K.__value=e(S))==null?"":e(S),ut(K,e(S)))},[()=>({expanded:p()})],ue),se("change",K,q),u(s,M),Fe(),$()}var os=I('<button type="button" class="media-preview-button svelte-1mjurqb"><img class="media-preview svelte-1mjurqb"></button>'),rs=I('<audio controls class="media-preview svelte-1mjurqb">Your browser does not support the audio element.</audio>'),ls=I('<video controls class="media-preview svelte-1mjurqb"><track kind="captions" src="" label="English captions" class="svelte-1mjurqb"> Your browser does not support the video element.</video>',2),ns=I('<div class="file-size svelte-1mjurqb"> </div>'),is=I('<span class="document-status success svelte-1mjurqb"> </span>'),cs=I('<span class="document-status info svelte-1mjurqb">Document attached</span>'),vs=I('<span class="document-status success svelte-1mjurqb">Document processed</span>'),ds=I('<span class="document-status info svelte-1mjurqb">Document</span>'),us=I('<span class="document-status error svelte-1mjurqb">Failed to process document</span>'),ps=I('<div class="document-file svelte-1mjurqb" role="button" tabindex="0"><div class="file-icon svelte-1mjurqb">ðŸ“„</div> <div class="file-info svelte-1mjurqb"><div class="file-name svelte-1mjurqb"> </div> <!> <div class="file-status svelte-1mjurqb"><!></div></div></div>'),fs=I('<div class="media-container svelte-1mjurqb"></div>'),ms=I('<div class="message-bubble svelte-1mjurqb"><div class="content svelte-1mjurqb"><p class="svelte-1mjurqb"> </p></div> <!></div>'),gs=I('<button type="button" class="media-preview-button svelte-1mjurqb"><img class="media-preview svelte-1mjurqb"> <div class="image-caption svelte-1mjurqb">Click to view full size</div></button>'),hs=I('<audio controls class="media-preview svelte-1mjurqb">Your browser does not support the audio element.</audio>'),_s=I('<video controls class="media-preview svelte-1mjurqb"><track kind="captions" src="" label="English captions" class="svelte-1mjurqb"> Your browser does not support the video element.</video>',2),bs=I('<div class="media-container assistant-media svelte-1mjurqb"></div>'),ys=I('<details class="thinking svelte-1mjurqb"><summary class="svelte-1mjurqb">Show thinking</summary> <div class="thinking-content svelte-1mjurqb"><!></div></details>'),$s=I('<div class="typing-indicator svelte-1mjurqb"><span class="svelte-1mjurqb"></span> <span class="svelte-1mjurqb"></span> <span class="svelte-1mjurqb"></span></div>'),ws=I('<div class="content svelte-1mjurqb"><!> <!> <!> <!></div>'),ks=I('<div class="content system-message svelte-1mjurqb"><!></div>'),xs=I('<div class="timestamp svelte-1mjurqb"> </div>'),As=I('<div class="image-modal-overlay svelte-1mjurqb" role="dialog" aria-modal="true" tabindex="0"><div class="image-modal-content svelte-1mjurqb" role="presentation"><button class="close-modal svelte-1mjurqb" aria-label="Close image preview">Ã—</button> <img class="svelte-1mjurqb"> <div class="modal-caption svelte-1mjurqb"> </div></div></div>'),Ms=I("<div><!> <!></div> <!>",1);function Is(s,t){Ve(t,!1);const r=ie(),$=ie();let a=te(t,"message",8),m=te(t,"isStreaming",8,!1),n=te(t,"scrollToBottom",8,!1),o=ie(!1),z=ie(""),p=ie(""),i=ie();Qe(()=>{if(n()&&e(i)){const E=e(i).parentElement;E&&(E.scrollTop=E.scrollHeight)}});function S(E,P=2){if(E===0)return"0 Bytes";const K=1024,Z=P<0?0:P,W=["Bytes","KB","MB","GB","TB"],J=Math.floor(Math.log(E)/Math.log(K));return parseFloat((E/Math.pow(K,J)).toFixed(Z))+" "+W[J]}function y(E,P="Preview image"){_(z,E),_(p,P),_(o,!0)}function g(){_(o,!1)}Je(()=>xt(a()),()=>{_(r,new Date(a().timestamp).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"}))}),Je(()=>xt(a()),()=>{_($,`message ${a().role}`)}),_t(),Re();var w=Ms(),q=ve(w),M=c(q);{var j=E=>{var P=ms(),K=c(P),Z=c(K),W=c(Z,!0);l(Z),l(K);var J=x(K,2);{var oe=X=>{var ae=fs();Se(ae,5,()=>a().media,Ie,(ce,U,re)=>{var T=fe(),A=ve(T);{var k=h=>{var v=os(),D=c(v);be(D,"alt",`Image ${re+1}`),l(v),Y(()=>be(D,"src",e(U).preview)),se("click",v,()=>{e(U).preview&&y(e(U).preview,`Image ${re+1}`)}),se("keydown",v,V=>{if(V.key==="Enter"||V.key===" "){if(V.preventDefault(),!e(U).preview)return;y(e(U).preview,`Image ${re+1}`)}}),u(h,v)},b=(h,v)=>{{var D=le=>{var ke=rs();Y(()=>be(ke,"src",e(U).preview)),u(le,ke)},V=(le,ke)=>{{var f=R=>{var O=ls();Y(()=>be(O,"src",e(U).preview)),u(R,O)},d=(R,O)=>{{var ee=H=>{var pe=ps(),_e=x(c(pe),2),Me=c(_e),$e=c(Me,!0);l(Me);var Q=x(Me,2);{var N=Ee=>{var qe=ns(),Be=c(qe,!0);l(qe),Y(Ge=>he(Be,Ge),[()=>S(e(U).size)],ue),u(Ee,qe)};G(Q,Ee=>{e(U).size&&Ee(N)})}var me=x(Q,2),Ze=c(me);{var et=Ee=>{var qe=is(),Be=c(qe);l(qe),Y(Ge=>he(Be,`âœ“ Uploaded to OpenAI (ID: ${Ge??""}...)`),[()=>e(U).fileId.substring(0,8)],ue),u(Ee,qe)},Rt=(Ee,qe)=>{{var Be=Oe=>{var Xe=fe(),Vt=ve(Xe);{var Ft=He=>{var tt=cs();u(He,tt)},Bt=(He,tt)=>{{var Gt=De=>{var at=vs();u(De,at)},Wt=De=>{var at=ds();u(De,at)};G(He,De=>{a().role==="assistant"?De(Gt):De(Wt,!1)},tt)}};G(Vt,He=>{a().role==="user"?He(Ft):He(Bt,!1)})}u(Oe,Xe)},Ge=Oe=>{var Xe=us();u(Oe,Xe)};G(Ee,Oe=>{e(U).preview?Oe(Be):Oe(Ge,!1)},qe)}};G(Ze,Ee=>{e(U).fileId?Ee(et):Ee(Rt,!1)})}l(me),l(_e),l(pe),Y(()=>he($e,e(U).name||"Document")),u(H,pe)};G(R,H=>{e(U).type==="document"&&H(ee)},O)}};G(le,R=>{e(U).type==="video"?R(f):R(d,!1)},ke)}};G(h,le=>{e(U).type==="audio"?le(D):le(V,!1)},v)}};G(A,h=>{e(U).type==="image"?h(k):h(b,!1)})}u(ce,T)}),l(ae),u(X,ae)};G(J,X=>{a().media&&a().media.length>0&&X(oe)})}l(P),Y(()=>he(W,a().content)),u(E,P)},F=(E,P)=>{{var K=W=>{var J=ws(),oe=c(J);ot(oe,{get content(){return a().content},get scrollToBottom(){return n()}});var X=x(oe,2);{var ae=A=>{var k=bs();Se(k,5,()=>a().media,Ie,(b,h,v)=>{var D=fe(),V=ve(D);{var le=f=>{var d=gs(),R=c(d);be(R,"alt",`Generated image ${v+1}`),Ne(2),l(d),Y(()=>be(R,"src",e(h).preview)),se("click",d,()=>{e(h).preview&&y(e(h).preview,`Generated image ${v+1}`)}),se("keydown",d,O=>{if(O.key==="Enter"||O.key===" "){if(O.preventDefault(),!e(h).preview)return;y(e(h).preview,`Generated image ${v+1}`)}}),u(f,d)},ke=(f,d)=>{{var R=ee=>{var H=hs();Y(()=>be(H,"src",e(h).preview)),u(ee,H)},O=(ee,H)=>{{var pe=_e=>{var Me=_s();Y(()=>be(Me,"src",e(h).preview)),u(_e,Me)};G(ee,_e=>{e(h).type==="video"&&_e(pe)},H)}};G(f,ee=>{e(h).type==="audio"?ee(R):ee(O,!1)},d)}};G(V,f=>{e(h).type==="image"?f(le):f(ke,!1)})}u(b,D)}),l(k),u(A,k)};G(X,A=>{a().media&&a().media.length>0&&A(ae)})}var ce=x(X,2);{var U=A=>{var k=ys(),b=x(c(k),2),h=c(b);ot(h,{get content(){return a().thinking},scrollToBottom:!1}),l(b),l(k),u(A,k)};G(ce,A=>{a().thinking&&A(U)})}var re=x(ce,2);{var T=A=>{var k=$s();u(A,k)};G(re,A=>{m()&&A(T)})}l(J),u(W,J)},Z=(W,J)=>{{var oe=X=>{var ae=ks(),ce=c(ae);ot(ce,{get content(){return a().content},get scrollToBottom(){return n()}}),l(ae),u(X,ae)};G(W,X=>{a().role==="system"&&X(oe)},J)}};G(E,W=>{a().role==="assistant"?W(K):W(Z,!1)},P)}};G(M,E=>{a().role==="user"?E(j):E(F,!1)})}var B=x(M,2);{var C=E=>{var P=xs(),K=c(P,!0);l(P),Y(()=>he(K,e(r))),u(E,P)};G(B,E=>{a().role==="user"&&E(C)})}l(q),bt(q,E=>_(i,E),()=>e(i));var L=x(q,2);{var de=E=>{var P=As(),K=c(P),Z=c(K),W=x(Z,2),J=x(W,2),oe=c(J,!0);l(J),l(K),l(P),Y(()=>{be(W,"src",e(z)),be(W,"alt",e(p)),he(oe,e(p))}),se("click",Z,g),se("click",K,Mt(()=>{})),se("keydown",K,Mt(()=>{})),se("click",P,g),se("keydown",P,X=>X.key==="Escape"&&g()),u(E,P)};G(L,E=>{e(o)&&E(de)})}Y(()=>Le(q,1,ha(e($)),"svelte-1mjurqb")),u(s,w),Fe()}var Ss=I('<img class="svelte-13xnbfc">'),Es=I('<div class="file-preview svelte-13xnbfc"><span> </span></div>'),Cs=I('<div class="media-item svelte-13xnbfc"><!> <button type="button" class="remove-media svelte-13xnbfc" aria-label="Remove media">&times;</button></div>'),Ps=I("<div><!></div>"),qs=I("<div><!></div>"),zs=I("<div><!></div>"),Ts=I('<button type="button"> </button>'),Ns=I('<div class="message-input-container svelte-13xnbfc"><div class="media-preview svelte-13xnbfc"></div> <div class="input-bubble svelte-13xnbfc"><div class="input-container svelte-13xnbfc"><textarea rows="2" class="svelte-13xnbfc"></textarea></div> <div class="actions-bar svelte-13xnbfc"><div class="left-actions svelte-13xnbfc"><input type="file" id="file-upload" hidden accept="image/*,audio/*,video/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,text/plain,text/csv,application/rtf,text/rtf,application/vnd.oasis.opendocument.text,application/vnd.oasis.opendocument.spreadsheet,application/vnd.oasis.opendocument.presentation" multiple> <!> <!> <!> <!></div> <div class="right-actions svelte-13xnbfc"><!></div></div></div> <div class="tools-bar svelte-13xnbfc"></div></div>');function js(s,t){Ve(t,!1);let r=te(t,"value",12,""),$=te(t,"placeholder",8,"Send a message..."),a=te(t,"disabled",8,!1),m=te(t,"isRecording",8,!1),n=te(t,"isCapturingVideo",8,!1),o=te(t,"mediaItems",28,()=>[]),z=te(t,"tools",24,()=>({}));const p=ht();let i=ie();function S(){e(i)&&(we(i,e(i).style.height="auto"),we(i,e(i).style.height=`${Math.min(e(i).scrollHeight,200)}px`))}function y(){a()||!r().trim()&&o().length===0||(p("submit",{content:r().trim(),media:o(),tools:z()}),r(""),e(i)&&we(i,e(i).style.height="auto"))}function g(b){b.key==="Enter"&&!b.shiftKey&&(b.preventDefault(),y())}function w(){m()?p("stopAudioCapture"):p("startAudioCapture")}function q(){n()?p("stopVideoCapture"):p("startVideoCapture")}function M(b){const h=b.target;if(h.files&&h.files.length>0){const v=Array.from(h.files);p("uploadFile",v),h.value=""}}function j(b){const h=!z()[b];p("toggleTool",{tool:b,enabled:h})}Je(()=>e(i),()=>{e(i)&&S()}),_t(),Re();var F=Ns(),B=c(F);Se(B,5,o,Ie,(b,h)=>{var v=Cs(),D=c(v);{var V=f=>{var d=Ss();Y(()=>{be(d,"src",e(h).preview),be(d,"alt",e(h).name)}),u(f,d)},le=f=>{var d=Es(),R=c(d),O=c(R,!0);l(R),l(d),Y(()=>he(O,e(h).name)),u(f,d)};G(D,f=>{e(h).type==="image"&&e(h).preview?f(V):f(le,!1)})}var ke=x(D,2);l(v),se("click",ke,()=>{o(o().filter(f=>f.id!==e(h).id))}),u(b,v)}),l(B);var C=x(B,2),L=c(C),de=c(L);fa(de),bt(de,b=>_(i,b),()=>e(i)),l(L);var E=x(L,2),P=c(E),K=c(P),Z=x(K,2);xe(Z,{variant:"icon",size:"sm",get disabled(){return a()},"aria-label":"Upload file",$$events:{click:()=>{var b;return(b=document.getElementById("file-upload"))==null?void 0:b.click()}},children:(b,h)=>{Dt(b,{size:18})},$$slots:{default:!0}});var W=x(Z,2);const J=ue(()=>a()||m()),oe=ue(()=>m()?"Stop recording":"Start recording");xe(W,{variant:"icon",size:"sm",get disabled(){return e(J)},get"aria-label"(){return e(oe)},$$events:{click:w},children:(b,h)=>{var v=Ps();let D;var V=c(v);Va(V,{size:18}),l(v),Y(le=>D=Le(v,1,"",null,D,le),[()=>({active:m()})],ue),u(b,v)},$$slots:{default:!0}});var X=x(W,2);const ae=ue(()=>a()||m()),ce=ue(()=>n()?"Stop video capture":"Start video capture");xe(X,{variant:"icon",size:"sm",get disabled(){return e(ae)},get"aria-label"(){return e(ce)},$$events:{click:q},children:(b,h)=>{var v=qs();let D;var V=c(v);Ga(V,{size:18}),l(v),Y(le=>D=Le(v,1,"",null,D,le),[()=>({active:n()})],ue),u(b,v)},$$slots:{default:!0}});var U=x(X,2);xe(U,{variant:"icon",size:"sm","aria-label":"Toggle web search",$$events:{click:()=>j("search")},children:(b,h)=>{var v=zs();let D;var V=c(v);Ka(V,{size:18}),l(v),Y(le=>D=Le(v,1,"",null,D,le),[()=>({active:z().search})],ue),u(b,v)},$$slots:{default:!0}}),l(P);var re=x(P,2),T=c(re);const A=ue(()=>a()||!r().trim()&&o().length===0);xe(T,{variant:"icon",size:"sm",get disabled(){return e(A)},"aria-label":"Send message",$$events:{click:y},children:(b,h)=>{Fa(b,{size:18})},$$slots:{default:!0}}),l(re),l(E),l(C);var k=x(C,2);Se(k,5,()=>Object.entries(z()),Ie,(b,h)=>{let v=()=>e(h)[0],D=()=>e(h)[1];var V=fe(),le=ve(V);{var ke=f=>{var d=Ts();let R;var O=c(d,!0);l(d),Y(ee=>{R=Le(d,1,"tool-button svelte-13xnbfc",null,R,ee),be(d,"aria-label",`Toggle ${v()??""}`),he(O,v())},[()=>({enabled:D()})],ue),se("click",d,()=>j(v())),u(f,d)};G(le,f=>{v()!=="search"&&f(ke)})}u(b,V)}),l(k),l(F),Y(()=>{be(de,"placeholder",$()),de.disabled=a()}),Ke(de,r),se("keydown",de,g),se("input",de,S),se("change",K,M),u(s,F),Fe()}var Ls=I('<span class="success-message svelte-8a76oy">API keys saved successfully!</span>'),Os=I('<span class="error-message svelte-8a76oy"> </span>'),Hs=I('<div class="settings-overlay svelte-8a76oy" role="dialog" aria-modal="true" tabindex="-1"><div class="settings-modal svelte-8a76oy"><div class="settings-header svelte-8a76oy"><h2 class="svelte-8a76oy">Settings</h2> <!></div> <div class="settings-content svelte-8a76oy"><section class="svelte-8a76oy"><h3 class="svelte-8a76oy">API Keys</h3> <p class="description svelte-8a76oy">Add your API keys to use different LLM providers. Keys are stored locally in your browser and never sent out anywhere.</p> <div class="api-keys-form svelte-8a76oy"><div class="form-group svelte-8a76oy"><label for="anthropic-key" class="svelte-8a76oy">Anthropic API Key</label> <input id="anthropic-key" type="password" placeholder="Enter Anthropic API key" autocomplete="off" class="svelte-8a76oy"></div> <div class="form-group svelte-8a76oy"><label for="openai-key" class="svelte-8a76oy">OpenAI API Key</label> <input id="openai-key" type="password" placeholder="Enter OpenAI API key" autocomplete="off" class="svelte-8a76oy"></div> <div class="form-group svelte-8a76oy"><label for="google-key" class="svelte-8a76oy">Google AI API Key</label> <input id="google-key" type="password" placeholder="Enter Google AI API key" autocomplete="off" class="svelte-8a76oy"></div> <div class="form-group svelte-8a76oy"><label for="ollama-host" class="svelte-8a76oy">Ollama Host</label> <input id="ollama-host" type="text" placeholder="http://localhost:11434" autocomplete="off" class="svelte-8a76oy"> <small class="svelte-8a76oy">Example: http://localhost:11434</small></div> <div class="form-group svelte-8a76oy"><label for="local-host" class="svelte-8a76oy">Local LLM Host</label> <input id="local-host" type="text" placeholder="http://localhost:8000" autocomplete="off" class="svelte-8a76oy"> <small class="svelte-8a76oy">URL for your self-hosted LLM server</small></div></div> <div class="form-actions svelte-8a76oy"><!> <!> <!></div></section></div></div></div>');function Ds(s,t){Ve(t,!1);const[r,$]=yt(),a=()=>je(dt,"$settingsStore",r);let m=te(t,"isOpen",8,!1);const n=ht();let o=ie({anthropic:"",openai:"",google:"",ollamaHost:"http://localhost:11434",localHost:"http://localhost:8000"}),z=ie(!1),p=ie(!1),i=ie("");Qe(()=>{console.log("Settings component mounted, current settingsStore value:",a());const M=a().apiKeys||{};console.log("Stored API keys from settings store:",M),_(o,{anthropic:M.anthropic||"",openai:M.openai||"",google:M.google||"",ollamaHost:M.ollamaHost||"http://localhost:11434",localHost:M.localHost||"http://localhost:8000"}),console.log("Initialized API key form with:",e(o))});function S(){n("close")}async function y(){var M;_(z,!0),_(p,!1),_(i,"");try{if(console.log("Saving API keys to settingsStore:",e(o)),e(o).openai){console.log("EXACT OPENAI KEY BEING SAVED: ",e(o).openai),console.log(`OpenAI key before saving: length=${e(o).openai.length}, starts with=${e(o).openai.substring(0,4)}`);const j=[...e(o).openai.substring(0,10)].map(F=>F.charCodeAt(0));console.log(`First 10 character codes: ${j.join(", ")}`)}if(await dt.updateApiKeys({anthropic:e(o).anthropic,openai:e(o).openai,google:e(o).google,ollamaHost:e(o).ollamaHost||"http://localhost:11434",localHost:e(o).localHost||"http://localhost:8000"}),console.log("API keys saved. Current settingsStore value:",a()),(M=a().apiKeys)!=null&&M.openai){console.log("EXACT OPENAI KEY AFTER SAVING: ",a().apiKeys.openai),console.log(`OpenAI key after saving: length=${a().apiKeys.openai.length}, starts with=${a().apiKeys.openai.substring(0,4)}`);const j=[...a().apiKeys.openai.substring(0,10)].map(F=>F.charCodeAt(0));console.log(`First 10 character codes after saving: ${j.join(", ")}`)}_(p,!0),console.log("API keys saved successfully"),setTimeout(()=>{_(p,!1)},3e3)}catch(j){console.error("Failed to save API keys:",j),_(i,j instanceof Error?j.message:"Unknown error")}finally{_(z,!1)}}Re();var g=fe(),w=ve(g);{var q=M=>{var j=Hs(),F=c(j),B=c(F),C=x(c(B),2);xe(C,{variant:"icon","aria-label":"Close settings",$$events:{click:S},children:(v,D)=>{Kt(v,{size:20})},$$slots:{default:!0}}),l(B);var L=x(B,2),de=c(L),E=x(c(de),4),P=c(E),K=x(c(P),2);We(K),l(P);var Z=x(P,2),W=x(c(Z),2);We(W),l(Z);var J=x(Z,2),oe=x(c(J),2);We(oe),l(J);var X=x(J,2),ae=x(c(X),2);We(ae),Ne(2),l(X);var ce=x(X,2),U=x(c(ce),2);We(U),Ne(2),l(ce),l(E);var re=x(E,2),T=c(re);xe(T,{variant:"primary",get disabled(){return e(z)},$$events:{click:y},children:(v,D)=>{Ne();var V=Xt();Y(()=>he(V,e(z)?"Saving...":"Save API Keys")),u(v,V)},$$slots:{default:!0}});var A=x(T,2);{var k=v=>{var D=Ls();u(v,D)};G(A,v=>{e(p)&&v(k)})}var b=x(A,2);{var h=v=>{var D=Os(),V=c(D,!0);l(D),Y(()=>he(V,e(i))),u(v,D)};G(b,v=>{e(i)&&v(h)})}l(re),l(de),l(L),l(F),l(j),Ke(K,()=>e(o).anthropic,v=>we(o,e(o).anthropic=v)),Ke(W,()=>e(o).openai,v=>we(o,e(o).openai=v)),Ke(oe,()=>e(o).google,v=>we(o,e(o).google=v)),Ke(ae,()=>e(o).ollamaHost,v=>we(o,e(o).ollamaHost=v)),Ke(U,()=>e(o).localHost,v=>we(o,e(o).localHost=v)),se("click",j,La(S)),se("keydown",j,v=>v.key==="Escape"&&S()),u(M,j)};G(w,M=>{m()&&M(q)})}u(s,g),Fe(),$()}var Ks=I('<div class="sidebar-backdrop svelte-u7neki" role="button" tabindex="0" aria-label="Close sidebar"></div>'),Rs=I('<div class="empty-state svelte-u7neki"><h2 class="svelte-u7neki">Start a new conversation</h2> <p class="svelte-u7neki">Send a message to start chatting with the AI assistant.</p> <div class="feature-highlights svelte-u7neki"><div class="feature svelte-u7neki"><!> <span>Attach files for analysis</span></div> <div class="feature svelte-u7neki"><!> <span>Vision support for images</span></div></div></div>'),Vs=I('<div class="settings-portal svelte-u7neki"><!></div>'),Fs=I('<div class="chat-container svelte-u7neki"><!> <!> <main class="chat-main svelte-u7neki"><header class="chat-header svelte-u7neki"><!> <h1 class="chat-title svelte-u7neki"> </h1> <!></header> <div class="chat-messages svelte-u7neki"><!></div> <div class="input-container svelte-u7neki"><!></div></main></div> <!>',1);function ao(s,t){Ve(t,!1);const[r,$]=yt(),a=()=>je(jt,"$activeChat",r),m=()=>je(dt,"$settingsStore",r);let n=ie(!1),o=ie(!0),z=ie(""),p=ie(!1),i=ie(!1),S=ie([]),y=ie({search:!1}),g=ie(),w=ie(!1);function q(){_(n,window.innerWidth<768),e(n)?_(o,!1):_(o,!0)}Qe(()=>(q(),window.addEventListener("resize",q),()=>{window.removeEventListener("resize",q)}));function M(){_(o,!e(o))}async function j({detail:f}){var pe,_e,Me;if(!a())return;const d=a().model.provider;if(console.log("Current settings store state:",m()),d==="openai"&&!((pe=m().apiKeys)!=null&&pe.openai)){console.warn("OpenAI API key not set, opening settings dialog"),_(w,!0),alert("Please set your OpenAI API key in Settings to use this model.");return}else if(d==="anthropic"&&!((_e=m().apiKeys)!=null&&_e.anthropic)){console.warn("Anthropic API key not set, opening settings dialog"),_(w,!0),alert("Please set your Anthropic API key in Settings to use this model.");return}else if(d==="google"&&!((Me=m().apiKeys)!=null&&Me.google)){console.warn("Google API key not set, opening settings dialog"),_(w,!0),alert("Please set your Google API key in Settings to use this model.");return}const{content:R,media:O,tools:ee}=f;console.log("Media items in submission:",O),await ne.addMessage(a().id,{role:"user",content:R,media:O}),_(z,""),_(S,[]),setTimeout(()=>{e(g)&&we(g,e(g).scrollTop=e(g).scrollHeight)},100);const H=await ne.addMessage(a().id,{role:"assistant",content:""});_(p,!0),_(i,!0);try{const $e=a().messages.slice(0,-1);console.log("Sending messages to LLM with media:",$e);const Q=a().model.id;if(d==="anthropic")await Ma(Q,$e,N=>{ne.updateMessage(a().id,H,{content:N})},()=>{_(p,!1),_(i,!1),setTimeout(()=>{e(g)&&we(g,e(g).scrollTop=e(g).scrollHeight)},100)},N=>{console.error("Error generating response:",N),ne.updateMessage(a().id,H,{content:`Error generating response: â€“ ${N.message}`}),_(p,!1),_(i,!1)},N=>{ne.updateMessage(a().id,H,{thinking:N})});else if(d==="openai")if(e(i))await Ia(Q,$e,N=>{ne.updateMessage(a().id,H,{content:N})},()=>{_(p,!1),_(i,!1),setTimeout(()=>{e(g)&&we(g,e(g).scrollTop=e(g).scrollHeight)},100)},N=>{console.error("Error generating response from OpenAI:",N);const me=N.message||"An unknown error occurred";ne.updateMessage(a().id,H,{content:`Error: ${me}`}),_(p,!1),_(i,!1)});else try{const N=await Sa(Q,$e);ne.updateMessage(a().id,H,{content:N}),_(p,!1)}catch(N){console.error("Error generating non-streaming response from OpenAI:",N);const me=N.message||"An unknown error occurred";throw ne.updateMessage(a().id,H,{content:`Error: ${me}`}),_(p,!1),N}else if(d==="google")await Ea(Q,$e,(N,me)=>{ne.updateMessage(a().id,H,{content:N,media:me})},()=>{_(p,!1),_(i,!1),setTimeout(()=>{e(g)&&we(g,e(g).scrollTop=e(g).scrollHeight)},100)},N=>{console.error("Error generating response from Google:",N);const me=N.message||"An unknown error occurred";ne.updateMessage(a().id,H,{content:`Error: ${me}`}),_(p,!1),_(i,!1)},N=>{ne.updateMessage(a().id,H,{thinking:N})});else if(d==="ollama")try{await Ca(Q,$e,N=>{ne.updateMessage(a().id,H,{content:N})},()=>{_(p,!1),_(i,!1),setTimeout(()=>{e(g)&&we(g,e(g).scrollTop=e(g).scrollHeight)},100)},N=>{console.error("Error generating response from Ollama:",N);const me=N.message||"An unknown error occurred";ne.updateMessage(a().id,H,{content:`Error connecting to Ollama: ${me}. Make sure Ollama is running locally.`}),_(p,!1),_(i,!1)})}catch(N){throw console.error("Error generating response from Ollama:",N),N}else{let N="";const me="This is a placeholder response. Please set up your API keys in Settings to use actual LLM services.".split(" ");for(const Ze of me)await new Promise(et=>setTimeout(et,50)),N+=Ze+" ",ne.updateMessage(a().id,H,{content:N.trim()});_(p,!1),_(i,!1)}}catch($e){if(console.error("Error generating response:",$e),e(p)){const Q=$e.message||"An unknown error occurred";ne.updateMessage(a().id,H,{content:`Error: ${Q}`}),_(p,!1),_(i,!1)}}}function F(f){f.forEach(async d=>{const R=xa(),O=d.name,ee=d.size;let H="other",pe,_e;console.log(`Processing file: ${O}, type: ${d.type}, size: ${ee} bytes`);const Me=Q=>{var N;if(Q.type.includes("pdf")||Q.type.includes("word")||Q.type.includes("excel")||Q.type.includes("spreadsheet")||Q.type.includes("presentation")||Q.type.includes("officedocument")||Q.type.includes("application/rtf")||Q.type.includes("text/rtf"))return!0;if(!Q.type||Q.type==="application/octet-stream"){const me=(N=O.split(".").pop())==null?void 0:N.toLowerCase();return["pdf","doc","docx","xls","xlsx","ppt","pptx","rtf","odt","ods","odp","csv"].includes(me||"")}return!1};if(d.type.startsWith("image/")){H="image";try{pe=await B(d),console.log(`Created data URL for image ${O} (length: ${pe.length} chars)`)}catch(Q){console.error(`Failed to create data URL for ${O}:`,Q)}}else if(d.type.startsWith("audio/"))H="audio";else if(d.type.startsWith("video/"))H="video";else if(d.type.startsWith("text/"))H="text";else if(Me(d)){if(H="document",a()&&a().model.provider==="openai")try{_e=await Aa(d),console.log(`Document ${O} uploaded to OpenAI with ID: ${_e}`)}catch(Q){console.error(`Failed to upload document to OpenAI: ${Q.message}`),alert(`Failed to upload document to OpenAI: ${Q.message}`)}try{pe=await B(d),console.log(`Created data URL for document ${O}, mime type: ${d.type}`),console.log(`Document data URL length: ${pe.length} chars`),ee>5*1024*1024&&console.warn(`Warning: Large document (${(ee/(1024*1024)).toFixed(2)}MB) may cause issues with API limits`)}catch(Q){console.error(`Failed to create data URL for ${O}:`,Q)}}const $e={id:R,type:H,name:O,preview:pe,size:ee,timestamp:Date.now(),fileId:_e};console.log(`Adding media item: ${H} ${O}`),_(S,[...e(S),$e])})}async function B(f){return new Promise((d,R)=>{const O=new FileReader;O.onload=()=>{const ee=O.result;d(ee)},O.onerror=ee=>{console.error("Error reading file:",ee),R(ee)},O.readAsDataURL(f)})}function C({detail:f}){const{tool:d,enabled:R}=f;_(y,{...e(y),[d]:R})}function L(){console.log("Start audio capture")}function de(){console.log("Stop audio capture")}function E(){console.log("Start video capture")}function P(){console.log("Stop video capture")}Re();var K=Fs(),Z=ve(K),W=c(Z);ss(W,{get isMobile(){return e(n)},get isExpanded(){return e(o)},$$events:{toggleSidebar:({detail:f})=>_(o,f)}});var J=x(W,2);{var oe=f=>{var d=Ks();se("click",d,()=>_(o,!1)),se("keydown",d,R=>R.key==="Escape"&&_(o,!1)),u(f,d)};G(J,f=>{e(n)&&e(o)&&f(oe)})}var X=x(J,2),ae=c(X),ce=c(ae);{var U=f=>{xe(f,{variant:"icon","aria-label":"Open menu",$$events:{click:M},children:(d,R)=>{Ht(d,{size:20})},$$slots:{default:!0}})};G(ce,f=>{e(n)&&f(U)})}var re=x(ce,2),T=c(re,!0);l(re);var A=x(re,2);xe(A,{variant:"icon","aria-label":"Open settings",$$events:{click:()=>_(w,!0)},children:(f,d)=>{Ba(f,{size:20})},$$slots:{default:!0}}),l(ae);var k=x(ae,2),b=c(k);{var h=f=>{var d=fe(),R=ve(d);Se(R,1,()=>a().messages,Ie,(O,ee,H)=>{const pe=ue(()=>e(i)&&H===a().messages.length-1&&e(ee).role==="assistant"),_e=ue(()=>H===a().messages.length-1);Is(O,{get message(){return e(ee)},get isStreaming(){return e(pe)},get scrollToBottom(){return e(_e)}})}),u(f,d)},v=f=>{var d=Rs(),R=x(c(d),4),O=c(R),ee=c(O);Dt(ee,{size:16}),Ne(2),l(O);var H=x(O,2),pe=c(H);Ra(pe,{size:16}),Ne(2),l(H),l(R),l(d),u(f,d)};G(b,f=>{a()&&a().messages.length>0?f(h):f(v,!1)})}l(k),bt(k,f=>_(g,f),()=>e(g));var D=x(k,2),V=c(D);js(V,{get tools(){return e(y)},get disabled(){return e(p)},placeholder:"Send a message...",get value(){return e(z)},set value(f){_(z,f)},get mediaItems(){return e(S)},set mediaItems(f){_(S,f)},$$events:{submit:j,uploadFile:f=>F(f.detail),toggleTool:C,startAudioCapture:L,stopAudioCapture:de,startVideoCapture:E,stopVideoCapture:P},$$legacy:!0}),l(D),l(X),l(Z);var le=x(Z,2);{var ke=f=>{var d=Vs(),R=c(d);Ds(R,{isOpen:!0,$$events:{close:()=>_(w,!1)}}),l(d),u(f,d)};G(le,f=>{e(w)&&f(ke)})}Y(()=>{var f;return he(T,((f=a())==null?void 0:f.model.name)||"AI Assistant")}),u(s,K),Fe(),$()}export{ao as component};
