import{a as Rt,n as Ut,b as _,c as fe,t as T,d as Vt}from"../chunks/D9u51XOd.js";import{i as Ue}from"../chunks/DSKYDh3O.js";import{v as wt,b as xt,s as Be,h as pe,j as kt,a as at,G as t,aa as ne,c as Kt,r as gt,d as We,g as ze,m as Ft,e as rt,f as it,p as At,aD as qe,t as Mt,a7 as Bt,y as st,aE as dt,aF as ht,aG as ct,B as Wt,$ as mt,aH as St,a4 as It,aI as jt,aJ as Gt,q as Yt,aK as Xt,aL as Et,aM as qt,k as Jt,E as Qt,aN as Zt,aO as ea,N as Ct,a6 as ta,a5 as aa,w as Ve,V as p,X as w,T as j,z as Ke,W as d,S as re,aP as vt,aQ as oe,al as Ye,aR as Ge,aS as ut,D as h,aT as Le,P as _t,aU as be}from"../chunks/BSv_i5Hy.js";import{s as me}from"../chunks/YMX71UVP.js";import{i as X}from"../chunks/Cec3cEQU.js";import{l as sa,m as oa,o as _e,p as na}from"../chunks/Bl1F-iLh.js";import{i as la,l as ye,p as q,s as ke,b as pt}from"../chunks/DYD2hZ7I.js";import{a as Ne,s as ft}from"../chunks/HG7v26tk.js";import{s as we,b as ot,C as ra,d as Oe,a as Ee,e as Pt,c as ee,f as ia,r as Fe}from"../chunks/DBQaLaxO.js";import{i as yt,o as da,g as ca,b as va,l as ua,c as pa,s as nt,u as fa,e as ga,f as ha,h as ma,j as _a,k as ya}from"../chunks/jxJ9CbTg.js";import{M as Je}from"../chunks/DmY3kN9U.js";function Se(a,e){return e}function $a(a,e,n,c){for(var s=[],f=e.length,l=0;l<f;l++)Gt(e[l].e,s,!0);var o=f>0&&s.length===0&&n!==null;if(o){var N=n.parentNode;Yt(N),N.append(n),c.clear(),Pe(a,e[0].prev,e[f-1].next)}Xt(s,()=>{for(var u=0;u<f;u++){var i=e[u];o||(c.delete(i.k),Pe(a,i.prev,i.next)),Et(i.e,!o)}})}function Ie(a,e,n,c,s,f=null){var l=a,o={flags:e,items:new Map,first:null},N=(e&St)!==0;if(N){var u=a;l=pe?Be(kt(u)):u.appendChild(wt())}pe&&at();var i=null,C=!1,g=ne(()=>{var m=n();return It(m)?m:m==null?[]:Mt(m)});xt(()=>{var m=t(g),y=m.length;if(C&&y===0)return;C=y===0;let L=!1;if(pe){var v=l.data===Kt;v!==(y===0)&&(l=gt(),Be(l),We(!1),L=!0)}if(pe){for(var M=null,P,H=0;H<y;H++){if(ze.nodeType===8&&ze.data===Ft){l=ze,L=!0,We(!1);break}var $=m[H],k=c($,H);P=zt(ze,o,M,null,$,k,H,s,e,n),o.items.set(k,P),M=P}y>0&&Be(gt())}pe||ba(m,o,l,s,e,c,n),f!==null&&(y===0?i?rt(i):i=it(()=>f(l)):i!==null&&At(i,()=>{i=null})),L&&We(!0),t(g)}),pe&&(l=ze)}function ba(a,e,n,c,s,f,l){var de,ce,Z,ae;var o=(s&jt)!==0,N=(s&(dt|ct))!==0,u=a.length,i=e.items,C=e.first,g=C,m,y=null,L,v=[],M=[],P,H,$,k;if(o)for(k=0;k<u;k+=1)P=a[k],H=f(P,k),$=i.get(H),$!==void 0&&((de=$.a)==null||de.measure(),(L??(L=new Set)).add($));for(k=0;k<u;k+=1){if(P=a[k],H=f(P,k),$=i.get(H),$===void 0){var J=g?g.e.nodes_start:n;y=zt(J,e,y,y===null?e.first:y.next,P,H,k,c,s,l),i.set(H,y),v=[],M=[],g=y.next;continue}if(N&&wa($,P,k,s),($.e.f&qe)!==0&&(rt($.e),o&&((ce=$.a)==null||ce.unfix(),(L??(L=new Set)).delete($))),$!==g){if(m!==void 0&&m.has($)){if(v.length<M.length){var B=M[0],W;y=B.prev;var te=v[0],O=v[v.length-1];for(W=0;W<v.length;W+=1)$t(v[W],B,n);for(W=0;W<M.length;W+=1)m.delete(M[W]);Pe(e,te.prev,O.next),Pe(e,y,te),Pe(e,O,B),g=B,y=O,k-=1,v=[],M=[]}else m.delete($),$t($,g,n),Pe(e,$.prev,$.next),Pe(e,$,y===null?e.first:y.next),Pe(e,y,$),y=$;continue}for(v=[],M=[];g!==null&&g.k!==H;)(g.e.f&qe)===0&&(m??(m=new Set)).add(g),M.push(g),g=g.next;if(g===null)continue;$=g}v.push($),y=$,g=$.next}if(g!==null||m!==void 0){for(var K=m===void 0?[]:Mt(m);g!==null;)(g.e.f&qe)===0&&K.push(g),g=g.next;var Q=K.length;if(Q>0){var ie=(s&St)!==0&&u===0?n:null;if(o){for(k=0;k<Q;k+=1)(Z=K[k].a)==null||Z.measure();for(k=0;k<Q;k+=1)(ae=K[k].a)==null||ae.fix()}$a(e,K,ie,i)}}o&&Bt(()=>{var z;if(L!==void 0)for($ of L)(z=$.a)==null||z.apply()}),st.first=e.first&&e.first.e,st.last=y&&y.e}function wa(a,e,n,c){(c&dt)!==0&&ht(a.v,e),(c&ct)!==0?ht(a.i,n):a.i=n}function zt(a,e,n,c,s,f,l,o,N,u){var i=(N&dt)!==0,C=(N&qt)===0,g=i?C?Wt(s):mt(s):s,m=(N&ct)===0?l:mt(l),y={i:m,v:g,k:f,a:null,e:null,prev:n,next:c};try{return y.e=it(()=>o(a,g,m,u),pe),y.e.prev=n&&n.e,y.e.next=c&&c.e,n===null?e.first=y:(n.next=y,n.e.next=y.e),c!==null&&(c.prev=y,c.e.prev=y.e),y}finally{}}function $t(a,e,n){for(var c=a.next?a.next.e.nodes_start:n,s=e?e.e.nodes_start:n,f=a.e.nodes_start;f!==c;){var l=Jt(f);s.before(f),f=l}}function Pe(a,e,n){e===null?a.first=n:(e.next=n,e.e.next=n&&n.e),n!==null&&(n.prev=e,n.e.prev=e&&e.e)}function xa(a,e,n,c,s,f){let l=pe;pe&&at();var o,N,u=null;pe&&ze.nodeType===1&&(u=ze,at());var i=pe?ze:a,C;xt(()=>{const g=e()||null;var m=Zt;g!==o&&(C&&(g===null?At(C,()=>{C=null,N=null}):g===N?rt(C):Et(C)),g&&g!==N&&(C=it(()=>{if(u=pe?u:document.createElementNS(m,g),Rt(u,u),c){pe&&sa(g)&&u.append(document.createComment(""));var y=pe?kt(u):u.appendChild(wt());pe&&(y===null?We(!1):Be(y)),c(u,y)}st.nodes_end=u,i.before(u)})),o=g,o&&(N=o))},Qt),l&&(We(!0),Be(i))}function Re(a,e,n=e){var c=ea();oa(a,"input",s=>{var f=s?a.defaultValue:a.value;if(f=Qe(a)?Ze(f):f,n(f),c&&f!==(f=e())){var l=a.selectionStart,o=a.selectionEnd;a.value=f??"",o!==null&&(a.selectionStart=l,a.selectionEnd=Math.min(o,a.value.length))}}),(pe&&a.defaultValue!==a.value||Ct(e)==null&&a.value)&&n(Qe(a)?Ze(a.value):a.value),ta(()=>{var s=e();Qe(a)&&s===Ze(a.value)||a.type==="date"&&!s&&!a.value||s!==a.value&&(a.value=s??"")})}function Qe(a){var e=a.type;return e==="number"||e==="range"}function Ze(a){return a===""?null:+a}function lt(a,e,n){if(a.multiple)return Aa(a,e);for(var c of a.options){var s=Tt(c);if(la(s,e)){c.selected=!0;return}}(!n||e!==void 0)&&(a.selectedIndex=-1)}function ka(a,e){let n=!0;aa(()=>{e&&lt(a,Ct(e),n),n=!1;var c=new MutationObserver(()=>{var s=a.__value;lt(a,s)});return c.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{c.disconnect()}})}function Aa(a,e){for(var n of a.options)n.selected=~e.indexOf(Tt(n))}function Tt(a){return"__value"in a?a.__value:a.value}function Ma(a){return function(...e){var n=e[0];n.target===this&&(a==null||a.apply(this,e))}}function et(a,e){var f;var n=(f=a.$$events)==null?void 0:f[e.type],c=It(n)?n.slice():n==null?[]:[n];for(var s of c)s.call(this,e)}const ue=[];for(let a=0;a<256;++a)ue.push((a+256).toString(16).slice(1));function Sa(a,e=0){return(ue[a[e+0]]+ue[a[e+1]]+ue[a[e+2]]+ue[a[e+3]]+"-"+ue[a[e+4]]+ue[a[e+5]]+"-"+ue[a[e+6]]+ue[a[e+7]]+"-"+ue[a[e+8]]+ue[a[e+9]]+"-"+ue[a[e+10]]+ue[a[e+11]]+ue[a[e+12]]+ue[a[e+13]]+ue[a[e+14]]+ue[a[e+15]]).toLowerCase()}let tt;const Ia=new Uint8Array(16);function Ea(){if(!tt){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");tt=crypto.getRandomValues.bind(crypto)}return tt(Ia)}const Ca=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),bt={randomUUID:Ca};function Pa(a,e,n){var s;if(bt.randomUUID&&!a)return bt.randomUUID();a=a||{};const c=a.random??((s=a.rng)==null?void 0:s.call(a))??Ea();if(c.length<16)throw new Error("Random bytes length must be >= 16");return c[6]=c[6]&15|64,c[8]=c[8]&63|128,Sa(c)}/**
 * @license lucide-svelte v0.479.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 */const za={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var Ta=Ut("<svg><!><!></svg>");function Ae(a,e){const n=ye(e,["children","$$slots","$$events","$$legacy"]),c=ye(n,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);Ve(e,!1);let s=q(e,"name",8,void 0),f=q(e,"color",8,"currentColor"),l=q(e,"size",8,24),o=q(e,"strokeWidth",8,2),N=q(e,"absoluteStrokeWidth",8,!1),u=q(e,"iconNode",24,()=>[]);const i=(...L)=>L.filter((v,M,P)=>!!v&&P.indexOf(v)===M).join(" ");Ue();var C=Ta();let g;var m=p(C);Ie(m,1,u,Se,(L,v)=>{let M=()=>t(v)[0],P=()=>t(v)[1];var H=fe(),$=re(H);xa($,M,!0,(k,J)=>{let B;j(()=>B=ot(k,B,{...P()}))}),_(L,H)});var y=w(m);we(y,e,"default",{}),d(C),j((L,v)=>g=ot(C,g,{...za,...c,width:l(),height:l(),stroke:f(),"stroke-width":L,class:v}),[()=>N()?Number(o())*24/Number(l()):o(),()=>i("lucide-icon","lucide",s()?`lucide-${s()}`:"",n.class)],ne),_(a,C),Ke()}function Na(a,e){const n=ye(e,["children","$$slots","$$events","$$legacy"]);Ae(a,ke({name:"camera"},()=>n,{iconNode:[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"}],["circle",{cx:"12",cy:"13",r:"3"}]],children:(s,f)=>{var l=fe(),o=re(l);we(o,e,"default",{}),_(s,l)},$$slots:{default:!0}}))}function La(a,e){const n=ye(e,["children","$$slots","$$events","$$legacy"]);Ae(a,ke({name:"chevron-left"},()=>n,{iconNode:[["path",{d:"m15 18-6-6 6-6"}]],children:(s,f)=>{var l=fe(),o=re(l);we(o,e,"default",{}),_(s,l)},$$slots:{default:!0}}))}function Oa(a,e){const n=ye(e,["children","$$slots","$$events","$$legacy"]);Ae(a,ke({name:"image"},()=>n,{iconNode:[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}],["circle",{cx:"9",cy:"9",r:"2"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"}]],children:(s,f)=>{var l=fe(),o=re(l);we(o,e,"default",{}),_(s,l)},$$slots:{default:!0}}))}function Ha(a,e){const n=ye(e,["children","$$slots","$$events","$$legacy"]);Ae(a,ke({name:"menu"},()=>n,{iconNode:[["line",{x1:"4",x2:"20",y1:"12",y2:"12"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18"}]],children:(s,f)=>{var l=fe(),o=re(l);we(o,e,"default",{}),_(s,l)},$$slots:{default:!0}}))}function Da(a,e){const n=ye(e,["children","$$slots","$$events","$$legacy"]);Ae(a,ke({name:"mic"},()=>n,{iconNode:[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22"}]],children:(s,f)=>{var l=fe(),o=re(l);we(o,e,"default",{}),_(s,l)},$$slots:{default:!0}}))}function Nt(a,e){const n=ye(e,["children","$$slots","$$events","$$legacy"]);Ae(a,ke({name:"paperclip"},()=>n,{iconNode:[["path",{d:"M13.234 20.252 21 12.3"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486"}]],children:(s,f)=>{var l=fe(),o=re(l);we(o,e,"default",{}),_(s,l)},$$slots:{default:!0}}))}function Ra(a,e){const n=ye(e,["children","$$slots","$$events","$$legacy"]);Ae(a,ke({name:"plus"},()=>n,{iconNode:[["path",{d:"M5 12h14"}],["path",{d:"M12 5v14"}]],children:(s,f)=>{var l=fe(),o=re(l);we(o,e,"default",{}),_(s,l)},$$slots:{default:!0}}))}function Ua(a,e){const n=ye(e,["children","$$slots","$$events","$$legacy"]);Ae(a,ke({name:"refresh-cw"},()=>n,{iconNode:[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]],children:(s,f)=>{var l=fe(),o=re(l);we(o,e,"default",{}),_(s,l)},$$slots:{default:!0}}))}function Va(a,e){const n=ye(e,["children","$$slots","$$events","$$legacy"]);Ae(a,ke({name:"send"},()=>n,{iconNode:[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]],children:(s,f)=>{var l=fe(),o=re(l);we(o,e,"default",{}),_(s,l)},$$slots:{default:!0}}))}function Ka(a,e){const n=ye(e,["children","$$slots","$$events","$$legacy"]);Ae(a,ke({name:"settings"},()=>n,{iconNode:[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}],["circle",{cx:"12",cy:"12",r:"3"}]],children:(s,f)=>{var l=fe(),o=re(l);we(o,e,"default",{}),_(s,l)},$$slots:{default:!0}}))}function Lt(a,e){const n=ye(e,["children","$$slots","$$events","$$legacy"]);Ae(a,ke({name:"x"},()=>n,{iconNode:[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]],children:(s,f)=>{var l=fe(),o=re(l);we(o,e,"default",{}),_(s,l)},$$slots:{default:!0}}))}var Fa=T('<div class="spinner svelte-1pi70xe"></div>'),Ba=T("<button><!> <!></button>");function xe(a,e){const n=ye(e,["children","$$slots","$$events","$$legacy"]),c=ye(n,["type","variant","size","disabled","loading","fullWidth"]);let s=q(e,"type",8,"button"),f=q(e,"variant",8,"primary"),l=q(e,"size",8,"md"),o=q(e,"disabled",8,!1),N=q(e,"loading",8,!1),u=q(e,"fullWidth",8,!1);var i=Ba();let C;var g=p(i);{var m=L=>{var v=Fa();_(L,v)};X(g,L=>{N()&&L(m)})}var y=w(g,2);we(y,e,"default",{}),d(i),j(L=>C=ot(i,C,{type:s(),class:`button ${f()??""} ${l()??""} ${(u()?"full-width":"")??""}`,disabled:o(),...c,[ra]:L},"svelte-1pi70xe"),[()=>({loading:N()})],ne),_e("click",i,function(L){et.call(this,e,L)}),_e("keydown",i,function(L){et.call(this,e,L)}),_e("keyup",i,function(L){et.call(this,e,L)}),_(a,i)}var Wa=T("<option> </option>"),ja=T('<optgroup label="Local Models" class="svelte-6bchvb"></optgroup>'),Ga=T("<option> </option>"),Ya=T("<option> </option>"),Xa=T("<option disabled> </option>"),qa=T("<span><!></span>"),Ja=T("<!> New Chat",1),Qa=T('<button type="button"><span class="chat-title svelte-6bchvb"> </span> <!></button>'),Za=T('<aside><div class="sidebar-header svelte-6bchvb"><div class="logo-container svelte-6bchvb"><img alt="Gervais Logo" class="logo svelte-6bchvb"> <h2 class="svelte-6bchvb">Gervais</h2></div> <!></div> <div class="sidebar-content svelte-6bchvb"><div class="model-selector svelte-6bchvb"><select class="select-styled svelte-6bchvb"><!><optgroup label="OpenAI Models" class="svelte-6bchvb"></optgroup><optgroup label="Google Models" class="svelte-6bchvb"></optgroup><optgroup label="Anthropic Models (Disabled)" class="svelte-6bchvb"></optgroup></select> <!></div> <!> <div class="chats-list svelte-6bchvb"></div></div></aside>');function es(a,e){var G;Ve(e,!1);const[n,c]=ft(),s=()=>Ne(Pt,"$activeChat",n),f=()=>Ne(pa,"$allModelsStore",n),l=()=>Ne(ua,"$localModelsStore",n),o=()=>Ne(ee,"$chatStore",n);let N=q(e,"isMobile",8,!1),u=q(e,"isExpanded",8,!0);const i=vt();let C=oe(((G=s())==null?void 0:G.model.id)||"claude-3-5-sonnet"),g=oe(!1);Ye(async()=>{h(g,!0),await yt(),h(g,!1)});async function m(){h(g,!0),await yt(),h(g,!1)}function y(){const A=f().find(S=>S.id===t(C));A&&ee.createNewChat(A)}function L(A){ee.selectChat(A),N()&&i("toggleSidebar",!1)}function v(A,S){S.stopPropagation(),ee.deleteChat(A)}function M(A){const S=A.target;if(h(C,S.value),s()){const r=f().find(b=>b.id===t(C));r&&ee.updateChatModel(s().id,r)}}Ge(()=>s(),()=>{s()&&h(C,s().model.id)}),ut(),Ue();var P=Za();let H;var $=p(P),k=p($),J=p(k);Le(2),d(k);var B=w(k,2);{var W=A=>{const S=ne(()=>u()?"Collapse sidebar":"Expand sidebar");xe(A,{variant:"icon",size:"sm",class:"collapse-button",get"aria-label"(){return t(S)},$$events:{click:()=>i("toggleSidebar",!u())},children:(r,b)=>{La(r,{size:20})},$$slots:{default:!0}})};X(B,A=>{N()&&A(W)})}d($);var te=w($,2),O=p(te),K=p(O);ka(K,()=>t(C));var Q,ie=p(K);{var de=A=>{var S=ja();Ie(S,5,l,Se,(r,b)=>{var V=Wa(),ge={},E=p(V,!0);d(V),j(()=>{ge!==(ge=t(b).id)&&(V.value=(V.__value=t(b).id)==null?"":t(b).id),me(E,t(b).name)}),_(r,V)}),d(S),_(A,S)};X(ie,A=>{l().length>0&&A(de)})}var ce=w(ie);Ie(ce,5,()=>da,Se,(A,S)=>{var r=Ga(),b={},V=p(r,!0);d(r),j(()=>{b!==(b=t(S).id)&&(r.value=(r.__value=t(S).id)==null?"":t(S).id),me(V,t(S).name)}),_(A,r)}),d(ce);var Z=w(ce);Ie(Z,5,()=>ca,Se,(A,S)=>{var r=Ya(),b={},V=p(r,!0);d(r),j(()=>{b!==(b=t(S).id)&&(r.value=(r.__value=t(S).id)==null?"":t(S).id),me(V,t(S).name)}),_(A,r)}),d(Z);var ae=w(Z);Ie(ae,5,()=>va,Se,(A,S)=>{var r=Xa(),b={},V=p(r,!0);d(r),j(()=>{b!==(b=t(S).id)&&(r.value=(r.__value=t(S).id)==null?"":t(S).id),me(V,t(S).name)}),_(A,r)}),d(ae),d(K);var z=w(K,2);xe(z,{variant:"icon",size:"sm",get disabled(){return t(g)},"aria-label":"Refresh models",$$events:{click:m},children:(A,S)=>{var r=qa();let b;var V=p(r);Ua(V,{size:16}),d(r),j(ge=>b=Oe(r,1,"svelte-6bchvb",null,b,ge),[()=>({loading:t(g)})],ne),_(A,r)},$$slots:{default:!0}}),d(O);var R=w(O,2);xe(R,{variant:"primary",size:"md",fullWidth:!0,class:"new-chat-button",$$events:{click:y},children:(A,S)=>{var r=Ja(),b=re(r);Ra(b,{size:16}),Le(),_(A,r)},$$slots:{default:!0}});var U=w(R,2);Ie(U,5,()=>o().chats,Se,(A,S)=>{var r=Qa();let b;var V=p(r),ge=p(V,!0);d(V);var E=w(V,2);xe(E,{variant:"icon",size:"sm","aria-label":"Delete chat",$$events:{click:x=>v(t(S).id,x)},children:(x,se)=>{Lt(x,{size:16})},$$slots:{default:!0}}),d(r),j(x=>{b=Oe(r,1,"chat-item svelte-6bchvb",null,b,x),me(ge,t(S).title||"New Chat")},[()=>{var x;return{active:t(S).id===((x=s())==null?void 0:x.id)}}],ne),_e("click",r,()=>L(t(S).id)),_(A,r)}),d(U),d(te),d(P),j(A=>{H=Oe(P,1,"sidebar svelte-6bchvb",null,H,A),Ee(J,"src","/gervais/logo.svg"),Q!==(Q=t(C))&&(K.value=(K.__value=t(C))==null?"":t(C),lt(K,t(C)))},[()=>({expanded:u()})],ne),_e("change",K,M),_(a,P),Ke(),c()}var ts=T('<button type="button" class="media-preview-button svelte-6ysygh"><img class="media-preview svelte-6ysygh"></button>'),as=T('<audio controls class="media-preview svelte-6ysygh">Your browser does not support the audio element.</audio>'),ss=T('<video controls class="media-preview svelte-6ysygh"><track kind="captions" src="" label="English captions" class="svelte-6ysygh"> Your browser does not support the video element.</video>',2),os=T('<div class="file-size svelte-6ysygh"> </div>'),ns=T('<span class="document-status success svelte-6ysygh"> </span>'),ls=T('<span class="document-status info svelte-6ysygh">Document attached</span>'),rs=T('<span class="document-status success svelte-6ysygh">Document processed</span>'),is=T('<span class="document-status error svelte-6ysygh">Failed to process document</span>'),ds=T('<div class="document-file svelte-6ysygh" role="button" tabindex="0"><div class="file-icon svelte-6ysygh">ðŸ“„</div> <div class="file-info svelte-6ysygh"><div class="file-name svelte-6ysygh"> </div> <!> <div class="file-status svelte-6ysygh"><!></div></div></div>'),cs=T('<div class="media-container svelte-6ysygh"></div>'),vs=T('<div class="message-bubble svelte-6ysygh"><div class="content svelte-6ysygh"><p class="svelte-6ysygh"> </p></div> <!></div>'),us=T('<details class="thinking svelte-6ysygh"><summary class="svelte-6ysygh">Show thinking</summary> <div class="thinking-content svelte-6ysygh"><!></div></details>'),ps=T('<div class="typing-indicator svelte-6ysygh"><span class="svelte-6ysygh"></span> <span class="svelte-6ysygh"></span> <span class="svelte-6ysygh"></span></div>'),fs=T('<div class="content svelte-6ysygh"><!> <!> <!></div>'),gs=T('<div class="content system-message svelte-6ysygh"><!></div>'),hs=T('<div class="timestamp svelte-6ysygh"> </div>'),ms=T("<div><!> <!></div>");function _s(a,e){Ve(e,!1);const n=oe(),c=oe();let s=q(e,"message",8),f=q(e,"isStreaming",8,!1),l=q(e,"scrollToBottom",8,!1),o=oe();Ye(()=>{if(l()&&t(o)){const v=t(o).parentElement;v&&(v.scrollTop=v.scrollHeight)}});function N(v,M=2){if(v===0)return"0 Bytes";const P=1024,H=M<0?0:M,$=["Bytes","KB","MB","GB","TB"],k=Math.floor(Math.log(v)/Math.log(P));return parseFloat((v/Math.pow(P,k)).toFixed(H))+" "+$[k]}function u(v){window.open(v,"_blank")}Ge(()=>_t(s()),()=>{h(n,new Date(s().timestamp).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"}))}),Ge(()=>_t(s()),()=>{h(c,`message ${s().role}`)}),ut(),Ue();var i=ms(),C=p(i);{var g=v=>{var M=vs(),P=p(M),H=p(P),$=p(H,!0);d(H),d(P);var k=w(P,2);{var J=B=>{var W=cs();Ie(W,5,()=>s().media,Se,(te,O,K)=>{var Q=fe(),ie=re(Q);{var de=Z=>{var ae=ts(),z=p(ae);Ee(z,"alt",`Image ${K+1}`),d(ae),j(()=>Ee(z,"src",t(O).preview)),_e("click",ae,()=>{t(O).preview&&u(t(O).preview)}),_e("keydown",ae,R=>{if(R.key==="Enter"||R.key===" "){if(R.preventDefault(),!t(O).preview)return;u(t(O).preview)}}),_(Z,ae)},ce=(Z,ae)=>{{var z=U=>{var G=as();j(()=>Ee(G,"src",t(O).preview)),_(U,G)},R=(U,G)=>{{var A=r=>{var b=ss();j(()=>Ee(b,"src",t(O).preview)),_(r,b)},S=(r,b)=>{{var V=ge=>{var E=ds(),x=w(p(E),2),se=p(x),Y=p(se,!0);d(se);var le=w(se,2);{var F=D=>{var I=os(),ve=p(I,!0);d(I),j(Te=>me(ve,Te),[()=>N(t(O).size)],ne),_(D,I)};X(le,D=>{t(O).size&&D(F)})}var he=w(le,2),Me=p(he);{var He=D=>{var I=ns(),ve=p(I);d(I),j(Te=>me(ve,`âœ“ Uploaded to OpenAI (ID: ${Te??""}...)`),[()=>t(O).fileId.substring(0,8)],ne),_(D,I)},$e=(D,I)=>{{var ve=Ce=>{var je=fe(),Ot=re(je);{var Ht=De=>{var Xe=ls();_(De,Xe)},Dt=De=>{var Xe=rs();_(De,Xe)};X(Ot,De=>{s().role==="user"?De(Ht):De(Dt,!1)})}_(Ce,je)},Te=Ce=>{var je=is();_(Ce,je)};X(D,Ce=>{t(O).preview?Ce(ve):Ce(Te,!1)},I)}};X(Me,D=>{t(O).fileId?D(He):D($e,!1)})}d(he),d(x),d(E),j(()=>me(Y,t(O).name||"Document")),_(ge,E)};X(r,ge=>{t(O).type==="document"&&ge(V)},b)}};X(U,r=>{t(O).type==="video"?r(A):r(S,!1)},G)}};X(Z,U=>{t(O).type==="audio"?U(z):U(R,!1)},ae)}};X(ie,Z=>{t(O).type==="image"?Z(de):Z(ce,!1)})}_(te,Q)}),d(W),_(B,W)};X(k,B=>{s().media&&s().media.length>0&&B(J)})}d(M),j(()=>me($,s().content)),_(v,M)},m=(v,M)=>{{var P=$=>{var k=fs(),J=p(k);Je(J,{get content(){return s().content},get scrollToBottom(){return l()}});var B=w(J,2);{var W=K=>{var Q=us(),ie=w(p(Q),2),de=p(ie);Je(de,{get content(){return s().thinking},scrollToBottom:!1}),d(ie),d(Q),_(K,Q)};X(B,K=>{s().thinking&&K(W)})}var te=w(B,2);{var O=K=>{var Q=ps();_(K,Q)};X(te,K=>{f()&&K(O)})}d(k),_($,k)},H=($,k)=>{{var J=B=>{var W=gs(),te=p(W);Je(te,{get content(){return s().content},get scrollToBottom(){return l()}}),d(W),_(B,W)};X($,B=>{s().role==="system"&&B(J)},k)}};X(v,$=>{s().role==="assistant"?$(P):$(H,!1)},M)}};X(C,v=>{s().role==="user"?v(g):v(m,!1)})}var y=w(C,2);{var L=v=>{var M=hs(),P=p(M,!0);d(M),j(()=>me(P,t(n))),_(v,M)};X(y,v=>{s().role==="user"&&v(L)})}d(i),pt(i,v=>h(o,v),()=>t(o)),j(()=>Oe(i,1,ia(t(c)),"svelte-6ysygh")),_(a,i),Ke()}var ys=T('<button type="button"> </button>'),$s=T('<img class="svelte-3d1bh">'),bs=T('<div class="file-preview svelte-3d1bh"><span> </span></div>'),ws=T('<div class="media-item svelte-3d1bh"><!> <button type="button" class="remove-media svelte-3d1bh" aria-label="Remove media">&times;</button></div>'),xs=T("<div><!></div>"),ks=T("<div><!></div>"),As=T('<div class="message-input-container svelte-3d1bh"><div class="tools-bar svelte-3d1bh"></div> <div class="media-preview svelte-3d1bh"></div> <div class="input-container svelte-3d1bh"><textarea rows="1" class="svelte-3d1bh"></textarea> <div class="actions svelte-3d1bh"><input type="file" id="file-upload" hidden accept="image/*,audio/*,video/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,text/plain,text/csv,application/rtf,text/rtf,application/vnd.oasis.opendocument.text,application/vnd.oasis.opendocument.spreadsheet,application/vnd.oasis.opendocument.presentation" multiple> <!> <!> <!> <!></div></div></div>');function Ms(a,e){Ve(e,!1);let n=q(e,"value",12,""),c=q(e,"placeholder",8,"Send a message..."),s=q(e,"disabled",8,!1),f=q(e,"isRecording",8,!1),l=q(e,"isCapturingVideo",8,!1),o=q(e,"mediaItems",28,()=>[]),N=q(e,"tools",24,()=>({}));const u=vt();let i=oe();function C(){t(i)&&(be(i,t(i).style.height="auto"),be(i,t(i).style.height=`${Math.min(t(i).scrollHeight,200)}px`))}function g(){s()||!n().trim()&&o().length===0||(u("submit",{content:n().trim(),media:o(),tools:N()}),n(""),t(i)&&be(i,t(i).style.height="auto"))}function m(z){z.key==="Enter"&&!z.shiftKey&&(z.preventDefault(),g())}function y(){f()?u("stopAudioCapture"):u("startAudioCapture")}function L(){l()?u("stopVideoCapture"):u("startVideoCapture")}function v(z){const R=z.target;if(R.files&&R.files.length>0){const U=Array.from(R.files);u("uploadFile",U),R.value=""}}function M(z){const R=!N()[z];u("toggleTool",{tool:z,enabled:R})}Ge(()=>t(i),()=>{t(i)&&C()}),ut(),Ue();var P=As(),H=p(P);Ie(H,5,()=>Object.entries(N()),Se,(z,R)=>{let U=()=>t(R)[0],G=()=>t(R)[1];var A=ys();let S;var r=p(A,!0);d(A),j(b=>{S=Oe(A,1,"tool-button svelte-3d1bh",null,S,b),Ee(A,"aria-label",`Toggle ${U()??""}`),me(r,U())},[()=>({enabled:G()})],ne),_e("click",A,()=>M(U())),_(z,A)}),d(H);var $=w(H,2);Ie($,5,o,Se,(z,R)=>{var U=ws(),G=p(U);{var A=b=>{var V=$s();j(()=>{Ee(V,"src",t(R).preview),Ee(V,"alt",t(R).name)}),_(b,V)},S=b=>{var V=bs(),ge=p(V),E=p(ge,!0);d(ge),d(V),j(()=>me(E,t(R).name)),_(b,V)};X(G,b=>{t(R).type==="image"&&t(R).preview?b(A):b(S,!1)})}var r=w(G,2);d(U),_e("click",r,()=>{o(o().filter(b=>b.id!==t(R).id))}),_(z,U)}),d($);var k=w($,2),J=p(k);na(J),pt(J,z=>h(i,z),()=>t(i));var B=w(J,2),W=p(B),te=w(W,2);xe(te,{variant:"icon",size:"sm",get disabled(){return s()},"aria-label":"Upload file",$$events:{click:()=>{var z;return(z=document.getElementById("file-upload"))==null?void 0:z.click()}},children:(z,R)=>{Nt(z,{size:18})},$$slots:{default:!0}});var O=w(te,2);const K=ne(()=>s()||l()),Q=ne(()=>f()?"Stop recording":"Start recording");xe(O,{variant:"icon",size:"sm",get disabled(){return t(K)},get"aria-label"(){return t(Q)},$$events:{click:y},children:(z,R)=>{var U=xs();let G;var A=p(U);Da(A,{size:18}),d(U),j(S=>G=Oe(U,1,"",null,G,S),[()=>({active:f()})],ne),_(z,U)},$$slots:{default:!0}});var ie=w(O,2);const de=ne(()=>s()||f()),ce=ne(()=>l()?"Stop video capture":"Start video capture");xe(ie,{variant:"icon",size:"sm",get disabled(){return t(de)},get"aria-label"(){return t(ce)},$$events:{click:L},children:(z,R)=>{var U=ks();let G;var A=p(U);Na(A,{size:18}),d(U),j(S=>G=Oe(U,1,"",null,G,S),[()=>({active:l()})],ne),_(z,U)},$$slots:{default:!0}});var Z=w(ie,2);const ae=ne(()=>s()||!n().trim()&&o().length===0);xe(Z,{variant:"icon",size:"sm",get disabled(){return t(ae)},"aria-label":"Send message",$$events:{click:g},children:(z,R)=>{Va(z,{size:18})},$$slots:{default:!0}}),d(B),d(k),d(P),j(()=>{Ee(J,"placeholder",c()),J.disabled=s()}),Re(J,n),_e("keydown",J,m),_e("change",W,v),_(a,P),Ke()}var Ss=T('<span class="success-message svelte-8a76oy">API keys saved successfully!</span>'),Is=T('<span class="error-message svelte-8a76oy"> </span>'),Es=T('<div class="settings-overlay svelte-8a76oy" role="dialog" aria-modal="true" tabindex="-1"><div class="settings-modal svelte-8a76oy"><div class="settings-header svelte-8a76oy"><h2 class="svelte-8a76oy">Settings</h2> <!></div> <div class="settings-content svelte-8a76oy"><section class="svelte-8a76oy"><h3 class="svelte-8a76oy">API Keys</h3> <p class="description svelte-8a76oy">Add your API keys to use different LLM providers. Keys are stored locally in your browser and never sent out anywhere.</p> <div class="api-keys-form svelte-8a76oy"><div class="form-group svelte-8a76oy"><label for="anthropic-key" class="svelte-8a76oy">Anthropic API Key</label> <input id="anthropic-key" type="password" placeholder="Enter Anthropic API key" autocomplete="off" class="svelte-8a76oy"></div> <div class="form-group svelte-8a76oy"><label for="openai-key" class="svelte-8a76oy">OpenAI API Key</label> <input id="openai-key" type="password" placeholder="Enter OpenAI API key" autocomplete="off" class="svelte-8a76oy"></div> <div class="form-group svelte-8a76oy"><label for="google-key" class="svelte-8a76oy">Google AI API Key</label> <input id="google-key" type="password" placeholder="Enter Google AI API key" autocomplete="off" class="svelte-8a76oy"></div> <div class="form-group svelte-8a76oy"><label for="ollama-host" class="svelte-8a76oy">Ollama Host</label> <input id="ollama-host" type="text" placeholder="http://localhost:11434" autocomplete="off" class="svelte-8a76oy"> <small class="svelte-8a76oy">Example: http://localhost:11434</small></div> <div class="form-group svelte-8a76oy"><label for="local-host" class="svelte-8a76oy">Local LLM Host</label> <input id="local-host" type="text" placeholder="http://localhost:8000" autocomplete="off" class="svelte-8a76oy"> <small class="svelte-8a76oy">URL for your self-hosted LLM server</small></div></div> <div class="form-actions svelte-8a76oy"><!> <!> <!></div></section></div></div></div>');function Cs(a,e){Ve(e,!1);const[n,c]=ft(),s=()=>Ne(nt,"$settingsStore",n);let f=q(e,"isOpen",8,!1);const l=vt();let o=oe({anthropic:"",openai:"",google:"",ollamaHost:"http://localhost:11434",localHost:"http://localhost:8000"}),N=oe(!1),u=oe(!1),i=oe("");Ye(()=>{console.log("Settings component mounted, current settingsStore value:",s());const v=s().apiKeys||{};console.log("Stored API keys from settings store:",v),h(o,{anthropic:v.anthropic||"",openai:v.openai||"",google:v.google||"",ollamaHost:v.ollamaHost||"http://localhost:11434",localHost:v.localHost||"http://localhost:8000"}),console.log("Initialized API key form with:",t(o))});function C(){l("close")}async function g(){var v;h(N,!0),h(u,!1),h(i,"");try{if(console.log("Saving API keys to settingsStore:",t(o)),t(o).openai){console.log("EXACT OPENAI KEY BEING SAVED: ",t(o).openai),console.log(`OpenAI key before saving: length=${t(o).openai.length}, starts with=${t(o).openai.substring(0,4)}`);const M=[...t(o).openai.substring(0,10)].map(P=>P.charCodeAt(0));console.log(`First 10 character codes: ${M.join(", ")}`)}if(await nt.updateApiKeys({anthropic:t(o).anthropic,openai:t(o).openai,google:t(o).google,ollamaHost:t(o).ollamaHost||"http://localhost:11434",localHost:t(o).localHost||"http://localhost:8000"}),console.log("API keys saved. Current settingsStore value:",s()),(v=s().apiKeys)!=null&&v.openai){console.log("EXACT OPENAI KEY AFTER SAVING: ",s().apiKeys.openai),console.log(`OpenAI key after saving: length=${s().apiKeys.openai.length}, starts with=${s().apiKeys.openai.substring(0,4)}`);const M=[...s().apiKeys.openai.substring(0,10)].map(P=>P.charCodeAt(0));console.log(`First 10 character codes after saving: ${M.join(", ")}`)}h(u,!0),console.log("API keys saved successfully"),setTimeout(()=>{h(u,!1)},3e3)}catch(M){console.error("Failed to save API keys:",M),h(i,M instanceof Error?M.message:"Unknown error")}finally{h(N,!1)}}Ue();var m=fe(),y=re(m);{var L=v=>{var M=Es(),P=p(M),H=p(P),$=w(p(H),2);xe($,{variant:"icon","aria-label":"Close settings",$$events:{click:C},children:(r,b)=>{Lt(r,{size:20})},$$slots:{default:!0}}),d(H);var k=w(H,2),J=p(k),B=w(p(J),4),W=p(B),te=w(p(W),2);Fe(te),d(W);var O=w(W,2),K=w(p(O),2);Fe(K),d(O);var Q=w(O,2),ie=w(p(Q),2);Fe(ie),d(Q);var de=w(Q,2),ce=w(p(de),2);Fe(ce),Le(2),d(de);var Z=w(de,2),ae=w(p(Z),2);Fe(ae),Le(2),d(Z),d(B);var z=w(B,2),R=p(z);xe(R,{variant:"primary",get disabled(){return t(N)},$$events:{click:g},children:(r,b)=>{Le();var V=Vt();j(()=>me(V,t(N)?"Saving...":"Save API Keys")),_(r,V)},$$slots:{default:!0}});var U=w(R,2);{var G=r=>{var b=Ss();_(r,b)};X(U,r=>{t(u)&&r(G)})}var A=w(U,2);{var S=r=>{var b=Is(),V=p(b,!0);d(b),j(()=>me(V,t(i))),_(r,b)};X(A,r=>{t(i)&&r(S)})}d(z),d(J),d(k),d(P),d(M),Re(te,()=>t(o).anthropic,r=>be(o,t(o).anthropic=r)),Re(K,()=>t(o).openai,r=>be(o,t(o).openai=r)),Re(ie,()=>t(o).google,r=>be(o,t(o).google=r)),Re(ce,()=>t(o).ollamaHost,r=>be(o,t(o).ollamaHost=r)),Re(ae,()=>t(o).localHost,r=>be(o,t(o).localHost=r)),_e("click",M,Ma(C)),_e("keydown",M,r=>r.key==="Escape"&&C()),_(v,M)};X(y,v=>{f()&&v(L)})}_(a,m),Ke(),c()}var Ps=T('<div class="sidebar-backdrop svelte-1jdnw89" role="button" tabindex="0" aria-label="Close sidebar"></div>'),zs=T('<div class="empty-state svelte-1jdnw89"><h2 class="svelte-1jdnw89">Start a new conversation</h2> <p class="svelte-1jdnw89">Send a message to start chatting with the AI assistant.</p> <div class="feature-highlights svelte-1jdnw89"><div class="feature svelte-1jdnw89"><!> <span>Attach files for analysis</span></div> <div class="feature svelte-1jdnw89"><!> <span>Vision support for images</span></div></div></div>'),Ts=T('<div class="chat-container svelte-1jdnw89"><!> <!> <main class="chat-main svelte-1jdnw89"><header class="chat-header svelte-1jdnw89"><!> <h1 class="chat-title svelte-1jdnw89"> </h1> <!></header> <div class="chat-messages svelte-1jdnw89"><!></div> <div class="input-container svelte-1jdnw89"><!></div></main></div> <!>',1);function Ws(a,e){Ve(e,!1);const[n,c]=ft(),s=()=>Ne(Pt,"$activeChat",n),f=()=>Ne(nt,"$settingsStore",n);let l=oe(!1),o=oe(!0),N=oe(""),u=oe(!1),i=oe(!1),C=oe([]),g=oe({search:!1}),m=oe(),y=oe(!1);function L(){h(l,window.innerWidth<768),t(l)?h(o,!1):h(o,!0)}Ye(()=>(L(),window.addEventListener("resize",L),()=>{window.removeEventListener("resize",L)}));function v(){h(o,!t(o))}async function M({detail:E}){var he,Me,He;if(!s())return;const x=s().model.provider;if(console.log("Current settings store state:",f()),x==="openai"&&!((he=f().apiKeys)!=null&&he.openai)){console.warn("OpenAI API key not set, opening settings dialog"),h(y,!0),alert("Please set your OpenAI API key in Settings to use this model.");return}else if(x==="anthropic"&&!((Me=f().apiKeys)!=null&&Me.anthropic)){console.warn("Anthropic API key not set, opening settings dialog"),h(y,!0),alert("Please set your Anthropic API key in Settings to use this model.");return}else if(x==="google"&&!((He=f().apiKeys)!=null&&He.google)){console.warn("Google API key not set, opening settings dialog"),h(y,!0),alert("Please set your Google API key in Settings to use this model.");return}const{content:se,media:Y,tools:le}=E;console.log("Media items in submission:",Y),await ee.addMessage(s().id,{role:"user",content:se,media:Y}),h(N,""),h(C,[]),setTimeout(()=>{t(m)&&be(m,t(m).scrollTop=t(m).scrollHeight)},100);const F=await ee.addMessage(s().id,{role:"assistant",content:""});h(u,!0),h(i,!0);try{const $e=s().messages.slice(0,-1);console.log("Sending messages to LLM with media:",$e);const D=s().model.id;if(x==="anthropic")await ga(D,$e,I=>{ee.updateMessage(s().id,F,{content:I})},()=>{h(u,!1),h(i,!1),setTimeout(()=>{t(m)&&be(m,t(m).scrollTop=t(m).scrollHeight)},100)},I=>{console.error("Error generating response:",I),ee.updateMessage(s().id,F,{content:`Error generating response: â€“ ${I.message}`}),h(u,!1),h(i,!1)},I=>{ee.updateMessage(s().id,F,{thinking:I})});else if(x==="openai")if(t(i))await ha(D,$e,I=>{ee.updateMessage(s().id,F,{content:I})},()=>{h(u,!1),h(i,!1),setTimeout(()=>{t(m)&&be(m,t(m).scrollTop=t(m).scrollHeight)},100)},I=>{console.error("Error generating response from OpenAI:",I);const ve=I.message||"An unknown error occurred";ee.updateMessage(s().id,F,{content:`Error: ${ve}`}),h(u,!1),h(i,!1)});else try{const I=await ma(D,$e);ee.updateMessage(s().id,F,{content:I}),h(u,!1)}catch(I){console.error("Error generating non-streaming response from OpenAI:",I);const ve=I.message||"An unknown error occurred";throw ee.updateMessage(s().id,F,{content:`Error: ${ve}`}),h(u,!1),I}else if(x==="google")await _a(D,$e,I=>{ee.updateMessage(s().id,F,{content:I})},()=>{h(u,!1),h(i,!1),setTimeout(()=>{t(m)&&be(m,t(m).scrollTop=t(m).scrollHeight)},100)},I=>{console.error("Error generating response from Google:",I);const ve=I.message||"An unknown error occurred";ee.updateMessage(s().id,F,{content:`Error: ${ve}`}),h(u,!1),h(i,!1)},I=>{ee.updateMessage(s().id,F,{thinking:I})});else if(x==="ollama")try{await ya(D,$e,I=>{ee.updateMessage(s().id,F,{content:I})},()=>{h(u,!1),h(i,!1),setTimeout(()=>{t(m)&&be(m,t(m).scrollTop=t(m).scrollHeight)},100)},I=>{console.error("Error generating response from Ollama:",I);const ve=I.message||"An unknown error occurred";ee.updateMessage(s().id,F,{content:`Error connecting to Ollama: ${ve}. Make sure Ollama is running locally.`}),h(u,!1),h(i,!1)})}catch(I){throw console.error("Error generating response from Ollama:",I),I}else{let I="";const ve="This is a placeholder response. Please set up your API keys in Settings to use actual LLM services.".split(" ");for(const Te of ve)await new Promise(Ce=>setTimeout(Ce,50)),I+=Te+" ",ee.updateMessage(s().id,F,{content:I.trim()});h(u,!1),h(i,!1)}}catch($e){if(console.error("Error generating response:",$e),t(u)){const D=$e.message||"An unknown error occurred";ee.updateMessage(s().id,F,{content:`Error: ${D}`}),h(u,!1),h(i,!1)}}}function P(E){E.forEach(async x=>{const se=Pa(),Y=x.name,le=x.size;let F="other",he,Me;console.log(`Processing file: ${Y}, type: ${x.type}, size: ${le} bytes`);const He=D=>{var I;if(D.type.includes("pdf")||D.type.includes("word")||D.type.includes("excel")||D.type.includes("spreadsheet")||D.type.includes("presentation")||D.type.includes("officedocument")||D.type.includes("application/rtf")||D.type.includes("text/rtf"))return!0;if(!D.type||D.type==="application/octet-stream"){const ve=(I=Y.split(".").pop())==null?void 0:I.toLowerCase();return["pdf","doc","docx","xls","xlsx","ppt","pptx","rtf","odt","ods","odp","csv"].includes(ve||"")}return!1};if(x.type.startsWith("image/")){F="image";try{he=await H(x),console.log(`Created data URL for image ${Y} (length: ${he.length} chars)`)}catch(D){console.error(`Failed to create data URL for ${Y}:`,D)}}else if(x.type.startsWith("audio/"))F="audio";else if(x.type.startsWith("video/"))F="video";else if(x.type.startsWith("text/"))F="text";else if(He(x)){if(F="document",s()&&s().model.provider==="openai")try{Me=await fa(x),console.log(`Document ${Y} uploaded to OpenAI with ID: ${Me}`)}catch(D){console.error(`Failed to upload document to OpenAI: ${D.message}`),alert(`Failed to upload document to OpenAI: ${D.message}`)}try{he=await H(x),console.log(`Created data URL for document ${Y}, mime type: ${x.type}`),console.log(`Document data URL length: ${he.length} chars`),le>5*1024*1024&&console.warn(`Warning: Large document (${(le/(1024*1024)).toFixed(2)}MB) may cause issues with API limits`)}catch(D){console.error(`Failed to create data URL for ${Y}:`,D)}}const $e={id:se,type:F,name:Y,preview:he,size:le,timestamp:Date.now(),fileId:Me};console.log(`Adding media item: ${F} ${Y}`),h(C,[...t(C),$e])})}async function H(E){return new Promise((x,se)=>{const Y=new FileReader;Y.onload=()=>{const le=Y.result;x(le)},Y.onerror=le=>{console.error("Error reading file:",le),se(le)},Y.readAsDataURL(E)})}function $({detail:E}){const{tool:x,enabled:se}=E;h(g,{...t(g),[x]:se})}function k(){console.log("Start audio capture")}function J(){console.log("Stop audio capture")}function B(){console.log("Start video capture")}function W(){console.log("Stop video capture")}Ue();var te=Ts(),O=re(te),K=p(O);es(K,{get isMobile(){return t(l)},get isExpanded(){return t(o)},$$events:{toggleSidebar:({detail:E})=>h(o,E)}});var Q=w(K,2);{var ie=E=>{var x=Ps();_e("click",x,()=>h(o,!1)),_e("keydown",x,se=>se.key==="Escape"&&h(o,!1)),_(E,x)};X(Q,E=>{t(l)&&t(o)&&E(ie)})}var de=w(Q,2),ce=p(de),Z=p(ce);{var ae=E=>{xe(E,{variant:"icon","aria-label":"Open menu",$$events:{click:v},children:(x,se)=>{Ha(x,{size:20})},$$slots:{default:!0}})};X(Z,E=>{t(l)&&E(ae)})}var z=w(Z,2),R=p(z,!0);d(z);var U=w(z,2);xe(U,{variant:"icon","aria-label":"Open settings",$$events:{click:()=>h(y,!0)},children:(E,x)=>{Ka(E,{size:20})},$$slots:{default:!0}}),d(ce);var G=w(ce,2),A=p(G);{var S=E=>{var x=fe(),se=re(x);Ie(se,1,()=>s().messages,Se,(Y,le,F)=>{const he=ne(()=>t(i)&&F===s().messages.length-1&&t(le).role==="assistant"),Me=ne(()=>F===s().messages.length-1);_s(Y,{get message(){return t(le)},get isStreaming(){return t(he)},get scrollToBottom(){return t(Me)}})}),_(E,x)},r=E=>{var x=zs(),se=w(p(x),4),Y=p(se),le=p(Y);Nt(le,{size:16}),Le(2),d(Y);var F=w(Y,2),he=p(F);Oa(he,{size:16}),Le(2),d(F),d(se),d(x),_(E,x)};X(A,E=>{s()&&s().messages.length>0?E(S):E(r,!1)})}d(G),pt(G,E=>h(m,E),()=>t(m));var b=w(G,2),V=p(b);Ms(V,{get tools(){return t(g)},get disabled(){return t(u)},placeholder:"Send a message...",get value(){return t(N)},set value(E){h(N,E)},get mediaItems(){return t(C)},set mediaItems(E){h(C,E)},$$events:{submit:M,uploadFile:E=>P(E.detail),toggleTool:$,startAudioCapture:k,stopAudioCapture:J,startVideoCapture:B,stopVideoCapture:W},$$legacy:!0}),d(b),d(de),d(O);var ge=w(O,2);Cs(ge,{get isOpen(){return t(y)},$$events:{close:()=>h(y,!1)}}),j(()=>{var E;return me(R,((E=s())==null?void 0:E.title)||"New Chat")}),_(a,te),Ke(),c()}export{Ws as component};
